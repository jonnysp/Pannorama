// Pannellum 8cb5902, https://github.com/mpetroff/pannellum
window.libpannellum=function(F,l,g){function ta(T){function Ya(a,e){return 1==a.level&&1!=e.level?-1:1==e.level&&1!=a.level?1:e.timestamp-a.timestamp}function U(a,e){return a.level!=e.level?a.level-e.level:a.diff-e.diff}function N(a,e,d,l,q,b){this.vertices=a;this.side=e;this.level=d;this.x=l;this.y=q;this.path=b.replace("%s",e).replace("%l",d).replace("%x",l).replace("%y",q)}function ua(a,e,l,m,q){var b;var k=e.vertices;b=ca(a,k.slice(0,3));var s=ca(a,k.slice(3,6)),g=ca(a,k.slice(6,9)),k=ca(a,k.slice(9,
12)),y=b[0]+s[0]+g[0]+k[0];-4==y||4==y?b=!1:(y=b[1]+s[1]+g[1]+k[1],b=-4==y||4==y?!1:4!=b[2]+s[2]+g[2]+k[2]);if(b){b=e.vertices;s=b[0]+b[3]+b[6]+b[9];g=b[1]+b[4]+b[7]+b[10];k=b[2]+b[5]+b[8]+b[11];y=Math.sqrt(s*s+g*g+k*k);k=Math.asin(k/y);s=Math.atan2(g,s)-m;s+=s>Math.PI?-2*Math.PI:s<-Math.PI?2*Math.PI:0;s=Math.abs(s);e.diff=Math.acos(Math.sin(l)*Math.sin(k)+Math.cos(l)*Math.cos(k)*Math.cos(s));s=!1;for(g=0;g<d.nodeCache.length;g++)if(d.nodeCache[g].path==e.path){s=!0;d.nodeCache[g].timestamp=d.nodeCacheTimestamp++;
d.nodeCache[g].diff=e.diff;d.currentNodes.push(d.nodeCache[g]);break}s||(e.timestamp=d.nodeCacheTimestamp++,d.currentNodes.push(e),d.nodeCache.push(e));if(e.level<d.level){var k=r.cubeResolution*Math.pow(2,e.level-r.maxLevel),s=Math.ceil(k*r.invTileResolution)-1,g=k%r.tileResolution*2,B=2*k%r.tileResolution;0===B&&(B=r.tileResolution);0===g&&(g=2*r.tileResolution);y=0.5;if(e.x==s||e.y==s)y=1-r.tileResolution/(r.tileResolution+B);var w=1-y,k=[],x=y,O=y,C=y,J=w,z=w,u=w;if(B<r.tileResolution)if(e.x==
s&&e.y!=s){if(z=O=0.5,"d"==e.side||"u"==e.side)u=C=0.5}else e.x!=s&&e.y==s&&(J=x=0.5,"l"==e.side||"r"==e.side)&&(u=C=0.5);g<=r.tileResolution&&(e.x==s&&(x=0,J=1,"l"==e.side||"r"==e.side)&&(C=0,u=1),e.y==s&&(O=0,z=1,"d"==e.side||"u"==e.side)&&(C=0,u=1));B=[b[0],b[1],b[2],b[0]*x+b[3]*J,b[1]*y+b[4]*w,b[2]*C+b[5]*u,b[0]*x+b[6]*J,b[1]*O+b[7]*z,b[2]*C+b[8]*u,b[0]*y+b[9]*w,b[1]*O+b[10]*z,b[2]*C+b[11]*u];B=new N(B,e.side,e.level+1,2*e.x,2*e.y,r.fullpath);k.push(B);e.x==s&&g<=r.tileResolution||(B=[b[0]*x+
b[3]*J,b[1]*y+b[4]*w,b[2]*C+b[5]*u,b[3],b[4],b[5],b[3]*y+b[6]*w,b[4]*O+b[7]*z,b[5]*C+b[8]*u,b[0]*x+b[6]*J,b[1]*O+b[7]*z,b[2]*C+b[8]*u],B=new N(B,e.side,e.level+1,2*e.x+1,2*e.y,r.fullpath),k.push(B));e.x==s&&g<=r.tileResolution||e.y==s&&g<=r.tileResolution||(B=[b[0]*x+b[6]*J,b[1]*O+b[7]*z,b[2]*C+b[8]*u,b[3]*y+b[6]*w,b[4]*O+b[7]*z,b[5]*C+b[8]*u,b[6],b[7],b[8],b[9]*x+b[6]*J,b[10]*y+b[7]*w,b[11]*C+b[8]*u],B=new N(B,e.side,e.level+1,2*e.x+1,2*e.y+1,r.fullpath),k.push(B));e.y==s&&g<=r.tileResolution||(B=
[b[0]*y+b[9]*w,b[1]*O+b[10]*z,b[2]*C+b[11]*u,b[0]*x+b[6]*J,b[1]*O+b[7]*z,b[2]*C+b[8]*u,b[9]*x+b[6]*J,b[10]*y+b[7]*w,b[11]*C+b[8]*u,b[9],b[10],b[11]],B=new N(B,e.side,e.level+1,2*e.x,2*e.y+1,r.fullpath),k.push(B));for(e=0;e<k.length;e++)ua(a,k[e],l,m,q)}}}function wa(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function fa(a,e,d){var g=Math.sin(e);e=Math.cos(e);
if("x"==d)return[a[0],e*a[1]+g*a[2],e*a[2]-g*a[1],a[3],e*a[4]+g*a[5],e*a[5]-g*a[4],a[6],e*a[7]+g*a[8],e*a[8]-g*a[7]];if("y"==d)return[e*a[0]-g*a[2],a[1],e*a[2]+g*a[0],e*a[3]-g*a[5],a[4],e*a[5]+g*a[3],e*a[6]-g*a[8],a[7],e*a[8]+g*a[6]];if("z"==d)return[e*a[0]+g*a[1],e*a[1]-g*a[0],a[2],e*a[3]+g*a[4],e*a[4]-g*a[3],a[5],e*a[6]+g*a[7],e*a[7]-g*a[6],a[8]]}function xa(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]}function ka(a){a.textureLoad||(a.textureLoad=
!0,Ga(encodeURI(a.path+"."+r.extension),function(e){a.texture=e;a.textureLoaded=!0}))}function ca(a,e){var d=[a[0]*e[0]+a[1]*e[1]+a[2]*e[2],a[4]*e[0]+a[5]*e[1]+a[6]*e[2],a[11]+a[8]*e[0]+a[9]*e[1]+a[10]*e[2],1/(a[12]*e[0]+a[13]*e[1]+a[14]*e[2])],g=d[0]*d[3],l=d[1]*d[3],d=d[2]*d[3],b=[0,0,0];-1>g&&(b[0]=-1);1<g&&(b[0]=1);-1>l&&(b[1]=-1);1<l&&(b[1]=1);if(-1>d||1<d)b[2]=1;return b}function la(){console.log("Reducing canvas size due to error 1286!");w.width=Math.round(w.width/2);w.height=Math.round(w.height/
2)}var w=l.createElement("canvas");w.style.width=w.style.height="100%";T.appendChild(w);var d,a,K,L,ya,S,ma,Y,r,z,ga,u,Z,na,W;this.init=function(f,e,Ea,ba,q,b,k,s){typeof e===g&&(e="equirectangular");if("equirectangular"!=e&&"cubemap"!=e&&"multires"!=e)throw console.log("Error: invalid image type specified!"),{type:"config error"};z=e;r=f;ga=Ea;if(d){K&&(a.detachShader(d,K),a.deleteShader(K));L&&(a.detachShader(d,L),a.deleteShader(L));a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
null);d.texture&&a.deleteTexture(d.texture);if(d.nodeCache)for(f=0;f<d.nodeCache.length;f++)a.deleteTexture(d.nodeCache[f].texture);a.deleteProgram(d);d=g}Y=g;"cubemap"==z&&0!==(r[0].width&r[0].width-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(a||(a=w.getContext("experimental-webgl",
{alpha:!1,depth:!1})),a&&1286==a.getError()&&la());if(!a&&("multires"==z&&r.hasOwnProperty("fallbackPath")||"cubemap"==z)&&("WebkitAppearance"in l.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){S&&T.removeChild(S);S=l.createElement("div");S.className="pnlm-world";ba=r.basePath?r.basePath+r.fallbackPath:r.fallbackPath;var ja="frblud".split(""),y=0;q=function(){var a=l.createElement("canvas");a.className="pnlm-face pnlm-"+ja[this.side]+
"face";S.appendChild(a);var b=a.getContext("2d");a.style.width=this.width+4+"px";a.style.height=this.height+4+"px";a.width=this.width+4;a.height=this.height+4;b.drawImage(this,2,2);var e=b.getImageData(0,0,a.width,a.height),d=e.data,g,f;for(g=2;g<a.width-2;g++)for(f=0;4>f;f++)d[4*(g+a.width)+f]=d[4*(g+2*a.width)+f],d[4*(g+a.width*(a.height-2))+f]=d[4*(g+a.width*(a.height-3))+f];for(g=2;g<a.height-2;g++)for(f=0;4>f;f++)d[4*(g*a.width+1)+f]=d[4*(g*a.width+2)+f],d[4*((g+1)*a.width-2)+f]=d[4*((g+1)*a.width-
3)+f];for(f=0;4>f;f++)d[4*(a.width+1)+f]=d[4*(2*a.width+2)+f],d[4*(2*a.width-2)+f]=d[4*(3*a.width-3)+f],d[4*(a.width*(a.height-2)+1)+f]=d[4*(a.width*(a.height-3)+2)+f],d[4*(a.width*(a.height-1)-2)+f]=d[4*(a.width*(a.height-2)-3)+f];for(g=1;g<a.width-1;g++)for(f=0;4>f;f++)d[4*g+f]=d[4*(g+a.width)+f],d[4*(g+a.width*(a.height-1))+f]=d[4*(g+a.width*(a.height-2))+f];for(g=1;g<a.height-1;g++)for(f=0;4>f;f++)d[g*a.width*4+f]=d[4*(g*a.width+1)+f],d[4*((g+1)*a.width-1)+f]=d[4*((g+1)*a.width-2)+f];for(f=0;4>
f;f++)d[f]=d[4*(a.width+1)+f],d[4*(a.width-1)+f]=d[4*(2*a.width-2)+f],d[a.width*(a.height-1)*4+f]=d[4*(a.width*(a.height-2)+1)+f],d[4*(a.width*a.height-1)+f]=d[4*(a.width*(a.height-1)-2)+f];b.putImageData(e,0,0);y++;6==y&&(ya=this.width,T.appendChild(S),k())};for(f=0;6>f;f++)b=new Image,b.crossOrigin="anonymous",b.side=f,b.onload=q,b.src="multires"==z?encodeURI(ba.replace("%s",ja[f])+"."+r.extension):encodeURI(r[f].src)}else{if(!a)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};
r.fullpath=r.basePath?r.basePath+r.path:r.path;r.invTileResolution=1/r.tileResolution;e=wa();ma=[];for(f=0;6>f;f++)ma[f]=e.slice(12*f,12*f+12),e=wa();if("equirectangular"==z){if(f=Math.max(r.width,r.height),e=a.getParameter(a.MAX_TEXTURE_SIZE),f>e)throw console.log("Error: The image is too big; it's "+f+"px wide, but this device's maximum supported width is "+e+"px."),{type:"webgl size error",width:f,maxWidth:e};}else if("cubemap"==z&&(f=r[0].width,e=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),f>
e))throw console.log("Error: The cube face image is too big; it's "+f+"px wide, but this device's maximum supported width is "+e+"px."),{type:"webgl size error",width:f,maxWidth:e};s===g||s.horizonPitch===g&&s.horizonRoll===g||(Y=[s.horizonPitch==g?0:s.horizonPitch,s.horizonRoll==g?0:s.horizonRoll]);f=a.TEXTURE_2D;a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight);K=a.createShader(a.VERTEX_SHADER);e=m;"multires"==z&&(e=x);a.shaderSource(K,e);a.compileShader(K);L=a.createShader(a.FRAGMENT_SHADER);
e=Ha;"cubemap"==z?(f=a.TEXTURE_CUBE_MAP,e=Ia):"multires"==z&&(e=ha);a.shaderSource(L,e);a.compileShader(L);d=a.createProgram();a.attachShader(d,K);a.attachShader(d,L);a.linkProgram(d);a.getShaderParameter(K,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(K));a.getShaderParameter(L,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(L));a.getProgramParameter(d,a.LINK_STATUS)||console.log(a.getProgramInfoLog(d));a.useProgram(d);d.drawInProgress=!1;d.texCoordLocation=a.getAttribLocation(d,"a_texCoord");
a.enableVertexAttribArray(d.texCoordLocation);"multires"!=z?(u||(u=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),a.STATIC_DRAW),a.vertexAttribPointer(d.texCoordLocation,2,a.FLOAT,!1,0,0),d.aspectRatio=a.getUniformLocation(d,"u_aspectRatio"),a.uniform1f(d.aspectRatio,w.clientWidth/w.clientHeight),d.psi=a.getUniformLocation(d,"u_psi"),d.theta=a.getUniformLocation(d,"u_theta"),d.f=a.getUniformLocation(d,"u_f"),d.h=a.getUniformLocation(d,
"u_h"),d.v=a.getUniformLocation(d,"u_v"),d.vo=a.getUniformLocation(d,"u_vo"),d.rot=a.getUniformLocation(d,"u_rot"),a.uniform1f(d.h,ba/(2*Math.PI)),a.uniform1f(d.v,q/Math.PI),a.uniform1f(d.vo,b/Math.PI*2),"equirectangular"==z&&(d.backgroundColor=a.getUniformLocation(d,"u_backgroundColor"),a.uniform4fv(d.backgroundColor,(s.backgroundColor?s.backgroundColor:[0,0,0]).concat([1]))),d.texture=a.createTexture(),a.bindTexture(f,d.texture),"cubemap"==z?(a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,a.RGB,a.RGB,
a.UNSIGNED_BYTE,r[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[5]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r[2])):a.texImage2D(f,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r),a.texParameteri(f,a.TEXTURE_WRAP_S,
a.CLAMP_TO_EDGE),a.texParameteri(f,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(f,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(f,a.TEXTURE_MAG_FILTER,a.LINEAR)):(d.vertPosLocation=a.getAttribLocation(d,"a_vertCoord"),a.enableVertexAttribArray(d.vertPosLocation),Z||(Z=a.createBuffer()),na||(na=a.createBuffer()),W||(W=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,na),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,W),a.bufferData(a.ELEMENT_ARRAY_BUFFER,
new Uint16Array([0,1,2,0,2,3]),a.STATIC_DRAW),d.perspUniform=a.getUniformLocation(d,"u_perspMatrix"),d.cubeUniform=a.getUniformLocation(d,"u_cubeMatrix"),d.level=-1,d.currentNodes=[],d.nodeCache=[],d.nodeCacheTimestamp=0);ba=a.getError();if(0!==ba)throw console.log("Error: Something went wrong with WebGL!",ba),{type:"webgl error"};k()}};this.destroy=function(){T!==g&&(w!==g&&T.removeChild(w),S!==g&&T.removeChild(S));if(a){var d=a.getExtension("WEBGL_lose_context");d&&d.loseContext()}};this.resize=
function(){var g=F.devicePixelRatio||1;w.width=w.clientWidth*g;w.height=w.clientHeight*g;a&&(1286==a.getError()&&la(),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),"multires"!=z&&a.uniform1f(d.aspectRatio,w.clientWidth/w.clientHeight))};this.resize();this.setPose=function(a,d){Y=[a,d]};this.render=function(f,e,l,m){var q;q=0;m===g&&(m={});m.roll&&(q=m.roll);if(Y!==g){var b=Y[0],k=Y[1],s=f,u=e,x=Math.cos(k)*Math.sin(f)*Math.sin(b)+Math.cos(f)*(Math.cos(b)*Math.cos(e)+Math.sin(k)*Math.sin(b)*
Math.sin(e)),B=-Math.sin(f)*Math.sin(k)+Math.cos(f)*Math.cos(k)*Math.sin(e);f=Math.cos(k)*Math.cos(b)*Math.sin(f)+Math.cos(f)*(-Math.cos(e)*Math.sin(b)+Math.cos(b)*Math.sin(k)*Math.sin(e));f=Math.asin(Math.max(Math.min(f,1),-1));e=Math.atan2(B,x);b=[Math.cos(s)*(Math.sin(k)*Math.sin(b)*Math.cos(u)-Math.cos(b)*Math.sin(u)),Math.cos(s)*Math.cos(k)*Math.cos(u),Math.cos(s)*(Math.cos(b)*Math.sin(k)*Math.cos(u)+Math.sin(u)*Math.sin(b))];k=[-Math.cos(f)*Math.sin(e),Math.cos(f)*Math.cos(e)];k=Math.acos(Math.max(Math.min((b[0]*
k[0]+b[1]*k[1])/(Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])*Math.sqrt(k[0]*k[0]+k[1]*k[1])),1),-1));0>b[2]&&(k=2*Math.PI-k);q+=k}if(a||"multires"!=z&&"cubemap"!=z){if("multires"!=z)l=2*Math.atan(Math.tan(0.5*l)/(w.clientWidth/w.clientHeight)),l=1/Math.tan(0.5*l),a.uniform1f(d.psi,e),a.uniform1f(d.theta,f),a.uniform1f(d.rot,q),a.uniform1f(d.f,l),!0===ga&&"equirectangular"==z&&(a.bindTexture(a.TEXTURE_2D,d.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,r)),a.drawArrays(a.TRIANGLES,0,
6);else{b=w.clientWidth/w.clientHeight;k=2*Math.atan(Math.tan(l/2)*w.clientHeight/w.clientWidth);k=1/Math.tan(k/2);b=[k/b,0,0,0,0,k,0,0,0,0,100.1/-99.9,20/-99.9,0,0,-1,0];for(k=1;k<r.maxLevel&&w.width>r.tileResolution*Math.pow(2,k-1)*Math.tan(l/2)*0.707;)k++;d.level=k;k=[1,0,0,0,1,0,0,0,1];k=fa(k,-q,"z");k=fa(k,-f,"x");k=fa(k,e,"y");k=[k[0],k[1],k[2],0,k[3],k[4],k[5],0,k[6],k[7],k[8],0,0,0,0,1];a.uniformMatrix4fv(d.perspUniform,!1,new Float32Array(xa(b)));a.uniformMatrix4fv(d.cubeUniform,!1,new Float32Array(xa(k)));
b=[b[0]*k[0],b[0]*k[1],b[0]*k[2],0,b[5]*k[4],b[5]*k[5],b[5]*k[6],0,b[10]*k[8],b[10]*k[9],b[10]*k[10],b[11],-k[8],-k[9],-k[10],0];d.nodeCache.sort(Ya);if(200<d.nodeCache.length&&d.nodeCache.length>d.currentNodes.length+50)for(k=d.nodeCache.splice(200,d.nodeCache.length-200),q=0;q<k.length;q++)a.deleteTexture(k[q].texture);d.currentNodes=[];k="fbudlr".split("");for(q=0;6>q;q++)s=new N(ma[q],k[q],1,0,0,r.fullpath),ua(b,s,f,e,l);d.currentNodes.sort(U);for(q=0;q<d.currentNodes.length;q++)if(!d.currentNodes[q].texture){setTimeout(ka,
0,d.currentNodes[q]);break}if(!d.drawInProgress){d.drawInProgress=!0;for(f=0;f<d.currentNodes.length;f++)d.currentNodes[f].textureLoaded&&(a.bindBuffer(a.ARRAY_BUFFER,Z),a.bufferData(a.ARRAY_BUFFER,new Float32Array(d.currentNodes[f].vertices),a.STATIC_DRAW),a.vertexAttribPointer(d.vertPosLocation,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,na),a.vertexAttribPointer(d.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,d.currentNodes[f].texture),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,
0));d.drawInProgress=!1}}if(m.returnImage!==g)return w.toDataURL("image/png")}else for(q=ya/2,m={f:"translate3d(-"+(q+2)+"px, -"+(q+2)+"px, -"+q+"px)",b:"translate3d("+(q+2)+"px, -"+(q+2)+"px, "+q+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(q+2)+"px, -"+q+"px, "+(q+2)+"px) rotateX(270deg)",d:"translate3d(-"+(q+2)+"px, "+q+"px, -"+(q+2)+"px) rotateX(90deg)",l:"translate3d(-"+q+"px, -"+(q+2)+"px, "+(q+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+q+"px, -"+(q+
2)+"px, -"+(q+2)+"px) rotateY(270deg)"},l=1/Math.tan(l/2),l=l*w.clientWidth/2+"px",f="perspective("+l+") translateZ("+l+") rotateX("+f+"rad) rotateY("+e+"rad) ",e=Object.keys(m),q=0;6>q;q++)l=S.querySelector(".pnlm-"+e[q]+"face").style,l.webkitTransform=f+m[e[q]],l.transform=f+m[e[q]]};this.isLoading=function(){if(a&&"multires"==z)for(var g=0;g<d.currentNodes.length;g++)if(!d.currentNodes[g].textureLoaded)return!0;return!1};this.getCanvas=function(){return w};var Ga=function(){function d(){var b=
this;this.texture=this.callback=null;this.image=new Image;this.image.crossOrigin="anonymous";this.image.addEventListener("load",function(){var d=b.image;a.bindTexture(a.TEXTURE_2D,b.texture);a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,
null);b.callback(b.texture);m.length?(d=m.shift(),b.loadTexture(d.src,d.texture,d.callback)):l[g++]=b})}function e(a,b,d){this.src=a;this.texture=b;this.callback=d}var g=4,l={},m=[];d.prototype.loadTexture=function(a,b,d){this.texture=b;this.callback=d;this.image.src=a};for(var b=0;b<g;b++)l[b]=new d;return function(b,d){var f=a.createTexture();g?l[--g].loadTexture(b,f,d):m.push(new e(b,f,d));return f}}()}var m="attribute vec2 a_texCoord;varying vec2 v_texCoord;void main() {gl_Position = vec4(a_texCoord, 0.0, 1.0);v_texCoord = a_texCoord;}",
x="attribute vec3 a_vertCoord;attribute vec2 a_texCoord;uniform mat4 u_cubeMatrix;uniform mat4 u_perspMatrix;varying mediump vec2 v_texCoord;void main(void) {gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);v_texCoord = a_texCoord;}",Ia="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);float cosphi = cos(phi);\ngl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\n}",
Ha="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);lambda = mod(lambda + PI, PI * 2.0) - PI;\nvec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\nif(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\ngl_FragColor = u_backgroundColor;\nelse\ngl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\n}",
ha="varying mediump vec2 v_texCoord;uniform sampler2D u_sampler;void main(void) {gl_FragColor = texture2D(u_sampler, v_texCoord);}";return{renderer:function(g,l,m,x){return new ta(g,l,m,x)}}}(window,document);window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(F,l){window.setTimeout(F,1E3/60)}}());
window.pannellum=function(F,l,g){function ta(m,x){function Ia(a){F.removeEventListener("deviceorientation",Ia);a&&null!==a.alpha&&null!==a.beta&&null!==a.gamma?(t.container.appendChild(t.orientation),za=!0,Ua&&Na()):za=!1}function Ha(){var a=l.createElement("div");a.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e";if(1==a.getElementsByTagName("i").length)U();else{oa=c.hfov;Aa=c.pitch;var h;if("cubemap"==c.type){M=[];for(a=0;6>a;a++)M.push(new Image),M[a].crossOrigin="anonymous";n.load.lbox.style.display=
"block";n.load.lbar.style.display="none"}else if("multires"==c.type)a=JSON.parse(JSON.stringify(c.multiRes)),c.basePath&&c.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(c.multiRes.basePath)?a.basePath=c.basePath+c.multiRes.basePath:c.multiRes.basePath?a.basePath=c.multiRes.basePath:c.basePath&&(a.basePath=c.basePath),M=a;else if(!0===c.dynamic)M=c.panorama;else{if(c.panorama===g){U("No panorama image was specified.");return}M=new Image}if("cubemap"==c.type)for(var b=6,d=function(){b--;0===b&&T()},
e=function(a){var D=l.createElement("a");D.href=a.target.src;D.innerHTML=D.href;U("The file "+D.outerHTML+" could not be accessed.")},a=0;a<M.length;a++)M[a].onload=d,M[a].onerror=e,h=c.cubeMap[a],c.basePath&&!ha(h)&&(h=c.basePath+h),M[a].src=encodeURI(h);else if("multires"==c.type)T();else if(h="",c.basePath&&(h=c.basePath),!0!==c.dynamic){h=ha(c.panorama)?c.panorama:h+c.panorama;M.onload=function(){F.URL.revokeObjectURL(this.src);T()};var f=new XMLHttpRequest;f.onloadend=function(){if(200!=f.status){var a=
l.createElement("a");a.href=encodeURI(h);a.innerHTML=a.href;U("The file "+a.outerHTML+" could not be accessed.")}ta(this.response);n.load.msg.innerHTML=""};f.onprogress=function(a){if(a.lengthComputable){n.load.lbarFill.style.width=a.loaded/a.total*100+"%";var D,c;1E6<a.total?(D="MB",c=(a.loaded/1E6).toFixed(2),a=(a.total/1E6).toFixed(2)):1E3<a.total?(D="kB",c=(a.loaded/1E3).toFixed(1),a=(a.total/1E3).toFixed(1)):(D="B",c=a.loaded,a=a.total);n.load.msg.innerHTML=c+" / "+a+" "+D}else n.load.lbox.style.display=
"block",n.load.lbar.style.display="none"};try{f.open("GET",h,!0)}catch(k){U("There is something wrong with the panorama URL.")}f.responseType="blob";f.setRequestHeader("Accept","image/*,*/*;q=0.9");f.send()}m.classList.add("pnlm-grab");m.classList.remove("pnlm-grabbing")}}function ha(a){return/^(?:[a-z]+:)?\/\//i.test(a)||"/"==a[0]||"blob:"==a.slice(0,5)}function T(){A||(A=new libpannellum.renderer(I));Oa||(Oa=!0,E.addEventListener("mousedown",ua,!1),l.addEventListener("mousemove",xa,!1),l.addEventListener("mouseup",
ka,!1),c.mouseZoom&&(m.addEventListener("mousewheel",L,!1),m.addEventListener("DOMMouseScroll",L,!1)),c.doubleClickZoom&&E.addEventListener("dblclick",wa,!1),m.addEventListener("mozfullscreenchange",y,!1),m.addEventListener("webkitfullscreenchange",y,!1),m.addEventListener("msfullscreenchange",y,!1),m.addEventListener("fullscreenchange",y,!1),F.addEventListener("resize",ga,!1),F.addEventListener("orientationchange",ga,!1),m.addEventListener("keydown",ya,!1),m.addEventListener("keyup",ma,!1),m.addEventListener("blur",
S,!1),l.addEventListener("mouseleave",ka,!1),E.addEventListener("touchstart",ca,!1),E.addEventListener("touchmove",la,!1),E.addEventListener("touchend",w,!1),E.addEventListener("pointerdown",d,!1),E.addEventListener("pointermove",a,!1),E.addEventListener("pointerup",K,!1),E.addEventListener("pointerleave",K,!1),F.navigator.pointerEnabled&&(m.style.touchAction="none"));f();setTimeout(function(){},500)}function ta(a){var h=new FileReader;h.addEventListener("loadend",function(){var b=h.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var d=
b.indexOf("\u00ff\u00c2");(0>d||65536<d)&&U("Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).")}d=b.indexOf("<x:xmpmeta");if(-1<d&&!0!==c.ignoreGPanoXMP){var e=b.substring(d,b.indexOf("</x:xmpmeta>")+12),f=function(a){var D;0<=e.indexOf(a+'="')?(D=e.substring(e.indexOf(a+'="')+a.length+2),D=D.substring(0,D.indexOf('"'))):0<=e.indexOf(a+">")&&(D=e.substring(e.indexOf(a+">")+a.length+1),D=D.substring(0,D.indexOf("<")));
return D!==g?Number(D):null},b=f("GPano:FullPanoWidthPixels"),d=f("GPano:CroppedAreaImageWidthPixels"),k=f("GPano:FullPanoHeightPixels"),l=f("GPano:CroppedAreaImageHeightPixels"),m=f("GPano:CroppedAreaTopPixels"),p=f("GPano:PoseHeadingDegrees"),n=f("GPano:PosePitchDegrees"),f=f("GPano:PoseRollDegrees");null!==b&&null!==d&&null!==k&&null!==l&&null!==m&&(0>X.indexOf("haov")&&(c.haov=d/b*360),0>X.indexOf("vaov")&&(c.vaov=l/k*180),0>X.indexOf("vOffset")&&(c.vOffset=-180*((m+l/2)/k-0.5)),null!==p&&0>X.indexOf("northOffset")&&
(c.northOffset=p,!1!==c.compass&&(c.compass=!0)),null!==n&&null!==f&&(0>X.indexOf("horizonPitch")&&(c.horizonPitch=n),0>X.indexOf("horizonRoll")&&(c.horizonRoll=f)))}M.src=F.URL.createObjectURL(a)});h.readAsBinaryString!==g?h.readAsBinaryString(a):h.readAsText(a)}function U(a){a===g&&(a="Your browser does not have the necessary WebGL support to display this panorama.");n.errorMsg.innerHTML="<p>"+a+"</p>";t.load.style.display="none";n.load.box.style.display="none";n.errorMsg.style.display="table";
Ja=!0;I.style.display="none";$("error",a)}function N(a){var c=m.getBoundingClientRect(),b={};b.x=a.clientX-c.left;b.y=a.clientY-c.top;return b}function ua(a){a.preventDefault();m.focus();if(H&&c.draggable){var h=N(a);if(c.hotSpotDebug){var b=fa(a);console.log("Pitch: "+b[0]+", Yaw: "+b[1]+", Center Pitch: "+c.pitch+", Center Yaw: "+c.yaw+", HFOV: "+c.hfov)}Fa();J();c.roll=0;v.hfov=0;da=!0;P=Date.now();pa=h.x;qa=h.y;Ka=c.yaw;La=c.pitch;m.classList.add("pnlm-grabbing");m.classList.remove("pnlm-grab");
$("mousedown",a);u()}}function wa(a){c.minHfov===c.hfov?ra.setHfov(oa,1E3):(a=fa(a),ra.lookAt(a[0],a[1],c.minHfov,1E3))}function fa(a){var h=N(a);a=A.getCanvas();var b=a.clientWidth,d=a.clientHeight;a=h.x/b*2-1;var d=(1-h.y/d*2)*d/b,e=1/Math.tan(c.hfov*Math.PI/360),g=Math.sin(c.pitch*Math.PI/180),f=Math.cos(c.pitch*Math.PI/180),h=e*f-d*g,b=Math.sqrt(a*a+h*h),d=180*Math.atan((d*f+e*g)/b)/Math.PI;a=180*Math.atan2(a/b,h/b)/Math.PI+c.yaw;-180>a&&(a+=360);180<a&&(a-=360);return[d,a]}function xa(a){if(da&&
H){P=Date.now();var h=A.getCanvas(),b=h.clientWidth,h=h.clientHeight;a=N(a);var d=180*(Math.atan(pa/b*2-1)-Math.atan(a.x/b*2-1))/Math.PI*c.hfov/90+Ka;v.yaw=(d-c.yaw)%360*0.2;c.yaw=d;b=360*Math.atan(Math.tan(c.hfov/360*Math.PI)*h/b)/Math.PI;b=180*(Math.atan(a.y/h*2-1)-Math.atan(qa/h*2-1))/Math.PI*b/90+La;v.pitch=0.2*(b-c.pitch);c.pitch=b}}function ka(a){da&&(da=!1,15<Date.now()-P&&(v.pitch=v.yaw=0),m.classList.add("pnlm-grab"),m.classList.remove("pnlm-grabbing"),P=Date.now(),$("mouseup",a))}function ca(a){if(H&&
c.draggable){Fa();J();c.roll=0;v.hfov=0;var h=N(a.targetTouches[0]);pa=h.x;qa=h.y;if(2==a.targetTouches.length){var b=N(a.targetTouches[1]);pa+=0.5*(b.x-h.x);qa+=0.5*(b.y-h.y);Ba=Math.sqrt((h.x-b.x)*(h.x-b.x)+(h.y-b.y)*(h.y-b.y))}da=!0;P=Date.now();Ka=c.yaw;La=c.pitch;$("touchstart",a);u()}}function la(a){if(c.draggable&&(a.preventDefault(),H&&(P=Date.now()),da&&H)){var h=N(a.targetTouches[0]),b=h.x,d=h.y;2==a.targetTouches.length&&-1!=Ba&&(a=N(a.targetTouches[1]),b+=0.5*(a.x-h.x),d+=0.5*(a.y-h.y),
h=Math.sqrt((h.x-a.x)*(h.x-a.x)+(h.y-a.y)*(h.y-a.y)),R(c.hfov+0.1*(Ba-h)),Ba=h);h=c.hfov/360;b=(pa-b)*h+Ka;v.yaw=(b-c.yaw)%360*0.2;c.yaw=b;d=(d-qa)*h+La;v.pitch=0.2*(d-c.pitch);c.pitch=d}}function w(){da=!1;150<Date.now()-P&&(v.pitch=v.yaw=0);Ba=-1;P=Date.now();$("touchend",event)}function d(a){"touch"==a.pointerType&&(ea.push(a.pointerId),sa.push({clientX:a.clientX,clientY:a.clientY}),a.targetTouches=sa,ca(a),a.preventDefault())}function a(a){if("touch"==a.pointerType)for(var c=0;c<ea.length;c++)if(a.pointerId==
ea[c]){sa[c].clientX=a.clientX;sa[c].clientY=a.clientY;a.targetTouches=sa;la(a);break}}function K(a){if("touch"==a.pointerType){for(var c=!1,b=0;b<ea.length;b++)a.pointerId==ea[b]&&(ea[b]=g),ea[b]&&(c=!0);c||(ea=[],sa=[],w());a.preventDefault()}}function L(a){H&&("fullscreenonly"!=c.mouseZoom||Ca)&&(a.preventDefault(),Fa(),P=Date.now(),a.wheelDeltaY?(R(c.hfov-0.05*a.wheelDeltaY),v.hfov=0>a.wheelDelta?1:-1):a.wheelDelta?(R(c.hfov-0.05*a.wheelDelta),v.hfov=0>a.wheelDelta?1:-1):a.detail&&(R(c.hfov+1.5*
a.detail),v.hfov=0<a.detail?1:-1),u())}function ya(a){Fa();P=Date.now();J();c.roll=0;var h=a.which||a.keycode;0>Va.indexOf(h)||(a.preventDefault(),27==h?Ca&&ja():Y(h,!0))}function S(){for(var a=0;10>a;a++)p[a]=!1}function ma(a){var c=a.which||a.keycode;0>Va.indexOf(c)||(a.preventDefault(),Y(c,!1))}function Y(a,c){var b=!1;switch(a){case 109:case 189:case 17:case 173:p[0]!=c&&(b=!0);p[0]=c;break;case 107:case 187:case 16:case 61:p[1]!=c&&(b=!0);p[1]=c;break;case 38:p[2]!=c&&(b=!0);p[2]=c;break;case 87:p[6]!=
c&&(b=!0);p[6]=c;break;case 40:p[3]!=c&&(b=!0);p[3]=c;break;case 83:p[7]!=c&&(b=!0);p[7]=c;break;case 37:p[4]!=c&&(b=!0);p[4]=c;break;case 65:p[8]!=c&&(b=!0);p[8]=c;break;case 39:p[5]!=c&&(b=!0);p[5]=c;break;case 68:p[9]!=c&&(b=!0),p[9]=c}b&&c&&(aa="undefined"!==typeof performance&&performance.now()?performance.now():Date.now(),u())}function r(){if(H){var a=!1,h=c.pitch,b=c.yaw,d=c.hfov,e;e="undefined"!==typeof performance&&performance.now()?performance.now():Date.now();aa===g&&(aa=e);var f=(e-aa)*
c.hfov/1700,f=Math.min(f,1);p[0]&&!0===c.keyboardZoom&&(R(c.hfov+(0.8*v.hfov+0.5)*f),a=!0);p[1]&&!0===c.keyboardZoom&&(R(c.hfov+(0.8*v.hfov-0.2)*f),a=!0);if(p[2]||p[6])c.pitch+=(0.8*v.pitch+0.2)*f,a=!0;if(p[3]||p[7])c.pitch+=(0.8*v.pitch-0.2)*f,a=!0;if(p[4]||p[8])c.yaw+=(0.8*v.yaw-0.2)*f,a=!0;if(p[5]||p[9])c.yaw+=(0.8*v.yaw+0.2)*f,a=!0;a&&(P=Date.now());Date.now();if(c.autoRotate){if(0.001<e-aa){var a=(e-aa)/1E3,k=(v.yaw/a*f-0.2*c.autoRotate)*a,k=(0<-c.autoRotate?1:-1)*Math.min(Math.abs(c.autoRotate*
a),Math.abs(k));c.yaw+=k}c.autoRotateStopDelay&&(c.autoRotateStopDelay-=e-aa,0>=c.autoRotateStopDelay&&(c.autoRotateStopDelay=!1,V=c.autoRotate,c.autoRotate=0))}G.pitch&&(z("pitch"),h=c.pitch);G.yaw&&(z("yaw"),b=c.yaw);G.hfov&&(z("hfov"),d=c.hfov);0<f&&!c.autoRotate&&(p[4]||p[5]||p[8]||p[9]||G.yaw||(c.yaw+=v.yaw*f*0.85),p[2]||p[3]||p[6]||p[7]||G.pitch||(c.pitch+=v.pitch*f*0.85),p[0]||p[1]||G.hfov||R(c.hfov+v.hfov*f*0.85));aa=e;0<f&&(v.yaw=0.8*v.yaw+(c.yaw-b)/f*0.2,v.pitch=0.8*v.pitch+(c.pitch-h)/
f*0.2,v.hfov=0.8*v.hfov+(c.hfov-d)/f*0.2,h=c.autoRotate?Math.abs(c.autoRotate):5,v.yaw=Math.min(h,Math.max(v.yaw,-h)),v.pitch=Math.min(h,Math.max(v.pitch,-h)),v.hfov=Math.min(h,Math.max(v.hfov,-h)));p[0]&&p[0]&&(v.hfov=0);(p[2]||p[6])&&(p[3]||p[7])&&(v.pitch=0);(p[4]||p[8])&&(p[5]||p[9])&&(v.yaw=0)}}function z(a){var h=G[a],b=Math.min(1,Math.max((Date.now()-h.startTime)/1E3/(h.duration/1E3),0)),b=h.startPosition+c.animationTimingFunction(b)*(h.endPosition-h.startPosition);if(h.endPosition>h.startPosition&&
b>=h.endPosition||h.endPosition<h.startPosition&&b<=h.endPosition||h.endPosition===h.startPosition){b=h.endPosition;v[a]=0;var h=G[a].callback,d=G[a].callbackArgs;delete G[a];"function"==typeof h&&h(d)}c[a]=b}function ga(){y()}function u(){Pa||(Pa=!0,Z())}function Z(){na();Qa&&clearTimeout(Qa);if(da||Ma)requestAnimationFrame(Z);else if(p[0]||p[1]||p[2]||p[3]||p[4]||p[5]||p[6]||p[7]||p[8]||p[9]||c.autoRotate||G.pitch||G.yaw||G.hfov||0.01<Math.abs(v.yaw)||0.01<Math.abs(v.pitch)||0.01<Math.abs(v.hfov))r(),
0<=c.autoRotateInactivityDelay&&V&&Date.now()-P>c.autoRotateInactivityDelay&&!c.autoRotate&&(c.autoRotate=V,ra.lookAt(Aa,g,oa,3E3)),requestAnimationFrame(Z);else if(A&&(A.isLoading()||!0===c.dynamic&&Wa))requestAnimationFrame(Z);else{Pa=!1;aa=g;var a=c.autoRotateInactivityDelay-(Date.now()-P);0<a?Qa=setTimeout(function(){c.autoRotate=V;ra.lookAt(Aa,g,oa,3E3);u()},a):0<=c.autoRotateInactivityDelay&&V&&(c.autoRotate=V,ra.lookAt(Aa,g,oa,3E3),u())}}function na(){var a;if(H){180<c.yaw?c.yaw-=360:-180>
c.yaw&&(c.yaw+=360);a=c.yaw;var h=c.maxYaw-c.minYaw,d=-180,e=180;360>h&&(d=c.minYaw+c.hfov/2,e=c.maxYaw-c.hfov/2,h<c.hfov&&(d=e=(d+e)/2));c.yaw=Math.max(d,Math.min(e,c.yaw));!1!==c.autoRotate&&a!=c.yaw&&(c.autoRotate*=-1);a=A.getCanvas();a=2*Math.atan(Math.tan(c.hfov/180*Math.PI*0.5)/(a.width/a.height))/Math.PI*180;h=c.minPitch+a/2;d=c.maxPitch-a/2;c.maxPitch-c.minPitch<a&&(h=d=(h+d)/2);isNaN(h)&&(h=-90);isNaN(d)&&(d=90);c.pitch=Math.max(h,Math.min(d,c.pitch));A.render(c.pitch*Math.PI/180,c.yaw*Math.PI/
180,c.hfov*Math.PI/180,{roll:c.roll*Math.PI/180});c.hotSpots.forEach(b);c.compass&&(Da.style.transform="rotate("+(-c.yaw-c.northOffset)+"deg)",Da.style.webkitTransform="rotate("+(-c.yaw-c.northOffset)+"deg)")}}function W(a,c,b,d){this.w=a;this.x=c;this.y=b;this.z=d}function Ga(a){var h;h=a.alpha;var b=a.beta;a=a.gamma;b=[b?b*Math.PI/180/2:0,a?a*Math.PI/180/2:0,h?h*Math.PI/180/2:0];h=[Math.cos(b[0]),Math.cos(b[1]),Math.cos(b[2])];b=[Math.sin(b[0]),Math.sin(b[1]),Math.sin(b[2])];h=new W(h[0]*h[1]*h[2]-
b[0]*b[1]*b[2],b[0]*h[1]*h[2]-h[0]*b[1]*b[2],h[0]*b[1]*h[2]+b[0]*h[1]*b[2],h[0]*h[1]*b[2]+b[0]*b[1]*h[2]);h=h.multiply(new W(Math.sqrt(0.5),-Math.sqrt(0.5),0,0));b=F.orientation?-F.orientation*Math.PI/180/2:0;h=h.multiply(new W(Math.cos(b),0,-Math.sin(b),0)).toEulerAngles();c.pitch=h[0]/Math.PI*180;c.roll=-h[1]/Math.PI*180;c.yaw=-h[2]/Math.PI*180+c.northOffset+Xa}function f(){try{var a={};c.horizonPitch!==g&&(a.horizonPitch=c.horizonPitch*Math.PI/180);c.horizonRoll!==g&&(a.horizonRoll=c.horizonRoll*
Math.PI/180);c.backgroundColor!==g&&(a.backgroundColor=c.backgroundColor);A.init(M,c.type,c.dynamic,c.haov*Math.PI/180,c.vaov*Math.PI/180,c.vOffset*Math.PI/180,e,a);!0!==c.dynamic&&(M=g)}catch(b){if("webgl error"==b.type||"no webgl"==b.type)U();else if("webgl size error"==b.type)U("This panorama is too big for your device! It's "+b.width+"px wide, but your device only supports images up to "+b.maxWidth+"px wide. Try another device. (If you're the author, try scaling down the image.)");else throw U("Unknown error. Check developer console."),
b;}}function e(){if(c.sceneFadeDuration&&A.fadeImg!==g){A.fadeImg.style.opacity=0;var a=A.fadeImg;delete A.fadeImg;setTimeout(function(){I.removeChild(a);$("scenechangefadedone")},c.sceneFadeDuration)}Da.style.display=c.compass?"inline":"none";ba();n.load.box.style.display="none";ia!==g&&(I.removeChild(ia),ia=g);H=!0;$("load");u()}function Ea(a){a.pitch=Number(a.pitch)||0;a.yaw=Number(a.yaw)||0;var b=l.createElement("div");b.className="pnlm-hotspot-base";b.className=a.cssClass?b.className+(" "+a.cssClass):
b.className+(" pnlm-hotspot pnlm-sprite pnlm-"+va(a.type));var d=l.createElement("span");a.text&&(d.innerHTML=va(a.text));var e;if(a.video){e=l.createElement("video");var f=a.video;c.basePath&&!ha(f)&&(f=c.basePath+f);e.src=encodeURI(f);e.controls=!0;e.style.width=a.width+"px";I.appendChild(b);d.appendChild(e)}else if(a.image){f=a.image;c.basePath&&!ha(f)&&(f=c.basePath+f);e=l.createElement("a");e.href=encodeURI(a.URL?a.URL:f);e.target="_blank";d.appendChild(e);var g=l.createElement("img");g.src=
encodeURI(f);g.style.width=a.width+"px";g.style.paddingTop="5px";I.appendChild(b);e.appendChild(g);d.style.maxWidth="initial"}else a.URL?(e=l.createElement("a"),e.href=encodeURI(a.URL),e.target="_blank",I.appendChild(e),b.style.cursor="pointer",d.style.cursor="pointer",e.appendChild(b)):(a.sceneId&&(b.onclick=b.ontouchend=function(){b.clicked||(b.clicked=!0,C(a.sceneId,a.targetPitch,a.targetYaw,a.targetHfov));return!1},b.style.cursor="pointer",d.style.cursor="pointer"),I.appendChild(b));if(a.createTooltipFunc)a.createTooltipFunc(b,
a.createTooltipArgs);else if(a.text||a.video||a.image)b.classList.add("pnlm-tooltip"),b.appendChild(d),d.style.width=d.scrollWidth-20+"px",d.style.marginLeft=-(d.scrollWidth-b.offsetWidth)/2+"px",d.style.marginTop=-d.scrollHeight-12+"px";a.clickHandlerFunc&&(b.addEventListener("click",function(c){a.clickHandlerFunc(c,a.clickHandlerArgs)},"false"),b.style.cursor="pointer",d.style.cursor="pointer");a.div=b}function ba(){Ra||(c.hotSpots?(c.hotSpots=c.hotSpots.sort(function(a,c){return a.pitch<c.pitch}),
c.hotSpots.forEach(Ea)):c.hotSpots=[],Ra=!0,c.hotSpots.forEach(b))}function q(){var a=c.hotSpots;Ra=!1;delete c.hotSpots;if(a)for(var b=0;b<a.length;b++){for(var d=a[b].div;d.parentNode!=I;)d=d.parentNode;I.removeChild(d);delete a.div}}function b(a){var b=Math.sin(a.pitch*Math.PI/180),d=Math.cos(a.pitch*Math.PI/180),e=Math.sin(c.pitch*Math.PI/180),f=Math.cos(c.pitch*Math.PI/180),g=Math.cos((-a.yaw+c.yaw)*Math.PI/180),k=b*e+d*g*f;if(90>=a.yaw&&-90<a.yaw&&0>=k||(90<a.yaw||-90>=a.yaw)&&0>=k)a.div.style.visibility=
"hidden";else{var l=Math.sin((-a.yaw+c.yaw)*Math.PI/180),m=Math.tan(c.hfov*Math.PI/360);a.div.style.visibility="visible";var p=A.getCanvas(),n=p.clientWidth,p=p.clientHeight,b=[-n/m*l*d/k/2,-n/m*(b*f-d*g*e)/k/2],d=Math.sin(c.roll*Math.PI/180),e=Math.cos(c.roll*Math.PI/180),b=[b[0]*e-b[1]*d,b[0]*d+b[1]*e];b[0]+=(n-a.div.offsetWidth)/2;b[1]+=(p-a.div.offsetHeight)/2;n="translate("+b[0]+"px, "+b[1]+"px) translateZ(9999px) rotate("+c.roll+"deg)";a.div.style.webkitTransform=n;a.div.style.MozTransform=
n;a.div.style.transform=n}}function k(a){c={};var b,d="haov vaov vOffset northOffset horizonPitch horizonRoll".split(" ");X=[];for(b in Sa)Sa.hasOwnProperty(b)&&(c[b]=Sa[b]);for(b in x.default)x.default.hasOwnProperty(b)&&(c[b]=x.default[b],0<=d.indexOf(b)&&X.push(b));if(null!==a&&""!==a&&x.scenes&&x.scenes[a]){var e=x.scenes[a];for(b in e)e.hasOwnProperty(b)&&(c[b]=e[b],0<=d.indexOf(b)&&X.push(b));c.scene=a}for(b in x)x.hasOwnProperty(b)&&(c[b]=x[b],0<=d.indexOf(b)&&X.push(b))}function s(a){if((a=
a?a:!1)&&"preview"in c){var b=c.preview;c.basePath&&!ha(b)&&(b=c.basePath+b);ia=l.createElement("div");ia.className="pnlm-preview-img";ia.style.backgroundImage="url('"+encodeURI(b)+"')";I.appendChild(ia)}var b=c.title,d=c.author;a&&("previewTitle"in c&&(c.title=c.previewTitle),"previewAuthor"in c&&(c.author=c.previewAuthor));c.hasOwnProperty("title")||(n.title.innerHTML="");c.hasOwnProperty("author")||(n.author.innerHTML="");c.hasOwnProperty("title")||c.hasOwnProperty("author")||(n.container.style.display=
"none");for(var e in c)if(c.hasOwnProperty(e))switch(e){case "title":n.title.innerHTML=va(c[e]);n.container.style.display="inline";break;case "author":n.author.innerHTML="by "+va(c[e]);n.container.style.display="inline";break;case "fallback":n.errorMsg.innerHTML='<p>Your browser does not support WebGL.<br><a href="'+encodeURI(c[e])+'" target="_blank">Click here to view this panorama in an alternative viewer.</a></p>';break;case "hfov":R(Number(c[e]));break;case "autoLoad":!0===c[e]&&A===g&&(n.load.box.style.display=
"inline",t.load.style.display="none",Ha());break;case "showZoomCtrl":t.zoom.style.display=c[e]&&!1!=c.showControls?"block":"none";break;case "showFullscreenCtrl":t.fullscreen.style.display=c[e]&&!1!=c.showControls&&("fullscreen"in l||"mozFullScreen"in l||"webkitIsFullScreen"in l||"msFullscreenElement"in l)?"block":"none";break;case "hotSpotDebug":Ta.style.display=c[e]?"block":"none";break;case "showControls":c[e]||(t.orientation.style.display="none",t.zoom.style.display="none",t.fullscreen.style.display=
"none");break;case "orientationOnByDefault":c[e]&&(za===g?Ua=!0:!0===za&&Na());break;case "loadButtonLabel":t.load.innerHTML="<p>"+va(c[e])+"</p>"}a&&(b?c.title=b:delete c.title,d?c.author=d:delete c.author)}function ja(){if(H&&!Ja)if(Ca)l.exitFullscreen?l.exitFullscreen():l.mozCancelFullScreen?l.mozCancelFullScreen():l.webkitCancelFullScreen?l.webkitCancelFullScreen():l.msExitFullscreen&&l.msExitFullscreen();else try{m.requestFullscreen?m.requestFullscreen():m.mozRequestFullScreen?m.mozRequestFullScreen():
m.msRequestFullscreen?m.msRequestFullscreen():m.webkitRequestFullScreen()}catch(a){}}function y(){l.fullscreen||l.mozFullScreen||l.webkitIsFullScreen||l.msFullscreenElement?(t.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),Ca=!0):(t.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),Ca=!1);A.resize();R(c.hfov);u()}function B(a){var b=c.minHfov;"multires"==c.type&&A&&(b=Math.min(b,A.getCanvas().width/(c.multiRes.cubeResolution/90*0.9)));return b>c.maxHfov?(console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),
c.hfov):a<b?b:a>c.maxHfov?c.maxHfov:a}function R(a){c.hfov=B(a)}function Fa(){G={};V=c.autoRotate?c.autoRotate:V;c.autoRotate=!1}function O(){Ja&&(n.load.box.style.display="none",n.errorMsg.style.display="none",Ja=!1,$("errorcleared"));t.load.style.display="none";n.load.box.style.display="inline";Ha()}function C(a,b,d,e,f){H=!1;G={};var l,m;if(c.sceneFadeDuration&&!f&&(l=A.render(c.pitch*Math.PI/180,c.yaw*Math.PI/180,c.hfov*Math.PI/180,{returnImage:!0}),l!==g)){f=new Image;f.className="pnlm-fade-img";
f.style.transition="opacity "+c.sceneFadeDuration/1E3+"s";f.style.width="100%";f.style.height="100%";f.onload=function(){C(a,b,d,e,!0)};f.src=l;I.appendChild(f);A.fadeImg=f;return}f="same"===b?c.pitch:b;l="same"===d?c.yaw:"sameAzimuth"===d?c.yaw+(c.northOffset||0)-(x.scenes[a].northOffset||0):d;m="same"===e?c.hfov:e;q();k(a);v.yaw=v.pitch=v.hfov=0;s();f!==g&&(c.pitch=f);l!==g&&(c.yaw=l);m!==g&&(c.hfov=m);$("scenechange",a);O()}function J(){F.removeEventListener("deviceorientation",Ga);t.orientation.classList.remove("pnlm-orientation-button-active");
Ma=!1}function Na(){Ma=!0;Xa=c.yaw;F.addEventListener("deviceorientation",Ga);t.orientation.classList.add("pnlm-orientation-button-active");requestAnimationFrame(Z)}function va(a){return x.escapeHTML?String(a).split(/&/g).join("&amp;").split('"').join("&quot;").split("'").join("&#39;").split("<").join("&lt;").split(">").join("&gt;").split("/").join("&#x2f;").split("\n").join("<br>"):String(a).split("\n").join("<br>")}function $(a){if(a in Q)for(var b=Q[a].length;0<b;b--)Q[a][Q[a].length-b].apply(null,
[].slice.call(arguments,1))}var ra=this,c,A,ia,da=!1,P=Date.now(),pa=0,qa=0,Ba=-1,Ka=0,La=0,p=Array(10),Ca=!1,H=!1,Ja=!1,Oa=!1,M,aa,v={yaw:0,pitch:0,hfov:0},Pa=!1,Ma=!1,Xa=0,Qa,V=0,oa,Aa,G={},Q={},X=[],Wa=!1,Ra=!1,Sa={hfov:100,minHfov:50,maxHfov:120,pitch:0,minPitch:g,maxPitch:g,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:g,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,doubleClickZoom:!0,keyboardZoom:!0,
mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0],animationTimingFunction:function(a){return 0.5>a?2*a*a:-1+(4-2*a)*a},loadButtonLabel:"Click to\nLoad\nPanorama",draggable:!0},Va=[16,17,27,37,38,39,40,61,65,68,83,87,107,109,173,187,189];m="string"===typeof m?l.getElementById(m):m;m.classList.add("pnlm-container");m.tabIndex=0;var I=l.createElement("div");I.className="pnlm-render-container";m.appendChild(I);var E=l.createElement("div");
E.className="pnlm-dragfix";m.appendChild(E);var n={},Ta=l.createElement("div");Ta.className="pnlm-sprite pnlm-hot-spot-debug-indicator";m.appendChild(Ta);n.container=l.createElement("div");n.container.className="pnlm-panorama-info";n.title=l.createElement("div");n.title.className="pnlm-title-box";n.container.appendChild(n.title);n.author=l.createElement("div");n.author.className="pnlm-author-box";n.container.appendChild(n.author);m.appendChild(n.container);n.load={};n.load.box=l.createElement("div");
n.load.box.className="pnlm-load-box";n.load.box.innerHTML="<p>Loading...</p>";n.load.lbox=l.createElement("div");n.load.lbox.className="pnlm-lbox";n.load.lbox.innerHTML='<div class="pnlm-loading"></div>';n.load.box.appendChild(n.load.lbox);n.load.lbar=l.createElement("div");n.load.lbar.className="pnlm-lbar";n.load.lbarFill=l.createElement("div");n.load.lbarFill.className="pnlm-lbar-fill";n.load.lbar.appendChild(n.load.lbarFill);n.load.box.appendChild(n.load.lbar);n.load.msg=l.createElement("p");n.load.msg.className=
"pnlm-lmsg";n.load.box.appendChild(n.load.msg);m.appendChild(n.load.box);n.errorMsg=l.createElement("div");n.errorMsg.className="pnlm-error-msg pnlm-info-box";m.appendChild(n.errorMsg);var t={};t.container=l.createElement("div");t.container.className="pnlm-controls-container";m.appendChild(t.container);t.load=l.createElement("div");t.load.className="pnlm-load-button";t.load.addEventListener("click",function(){s();O()});m.appendChild(t.load);t.zoom=l.createElement("div");t.zoom.className="pnlm-zoom-controls pnlm-controls";
t.zoomIn=l.createElement("div");t.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control";t.zoomIn.addEventListener("click",function(){H&&(R(c.hfov-5),u())});t.zoom.appendChild(t.zoomIn);t.zoomOut=l.createElement("div");t.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control";t.zoomOut.addEventListener("click",function(){H&&(R(c.hfov+5),u())});t.zoom.appendChild(t.zoomOut);t.container.appendChild(t.zoom);t.fullscreen=l.createElement("div");t.fullscreen.addEventListener("click",ja);t.fullscreen.className=
"pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control";(l.fullscreenEnabled||l.mozFullScreenEnabled||l.webkitFullscreenEnabled||l.msFullscreenEnabled)&&t.container.appendChild(t.fullscreen);t.orientation=l.createElement("div");t.orientation.addEventListener("click",function(a){Ma?J():Na()});t.orientation.addEventListener("mousedown",function(a){a.stopPropagation()});t.orientation.addEventListener("touchstart",function(a){a.stopPropagation()});
t.orientation.addEventListener("pointerdown",function(a){a.stopPropagation()});t.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control";var za,Ua=!1;F.DeviceOrientationEvent?F.addEventListener("deviceorientation",Ia):za=!1;var Da=l.createElement("div");Da.className="pnlm-compass pnlm-controls pnlm-control";m.appendChild(Da);x.firstScene?k(x.firstScene):x.default&&x.default.firstScene?k(x.default.firstScene):k(null);s(!0);var ea=[],sa=
[];W.prototype.multiply=function(a){return new W(this.w*a.w-this.x*a.x-this.y*a.y-this.z*a.z,this.x*a.w+this.w*a.x+this.y*a.z-this.z*a.y,this.y*a.w+this.w*a.y+this.z*a.x-this.x*a.z,this.z*a.w+this.w*a.z+this.x*a.y-this.y*a.x)};W.prototype.toEulerAngles=function(){var a=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),b=Math.asin(2*(this.w*this.y-this.z*this.x)),c=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return[a,b,c]};this.isLoaded=
function(){return H};this.getPitch=function(){return c.pitch};this.setPitch=function(a,b,d,e){(b=b==g?1E3:Number(b))?G.pitch={startTime:Date.now(),startPosition:c.pitch,endPosition:a,duration:b,callback:d,callbackArgs:e}:c.pitch=a;u();return this};this.getPitchBounds=function(){return[c.minPitch,c.maxPitch]};this.setPitchBounds=function(a){c.minPitch=Math.max(-90,Math.min(a[0],90));c.maxPitch=Math.max(-90,Math.min(a[1],90));return this};this.getYaw=function(){return c.yaw};this.setYaw=function(a,
b,d,e){(b=b==g?1E3:Number(b))?G.yaw={startTime:Date.now(),startPosition:c.yaw,endPosition:a,duration:b,callback:d,callbackArgs:e}:c.yaw=a;u();return this};this.getYawBounds=function(){return[c.minYaw,c.maxYaw]};this.setYawBounds=function(a){c.minYaw=Math.max(-180,Math.min(a[0],180));c.maxYaw=Math.max(-180,Math.min(a[1],180));return this};this.getHfov=function(){return c.hfov};this.setHfov=function(a,b,d,e){(b=b==g?1E3:Number(b))?G.hfov={startTime:Date.now(),startPosition:c.hfov,endPosition:B(a),duration:b,
callback:d,callbackArgs:e}:R(a);u();return this};this.getHfovBounds=function(){return[c.minHfov,c.maxHfov]};this.setHfovBounds=function(a){c.minHfov=Math.max(0,a[0]);c.maxHfov=Math.max(0,a[1]);return this};this.lookAt=function(a,b,c,d,e,f){d=d==g?1E3:Number(d);a!==g&&(this.setPitch(a,d,e,f),e=g);b!==g&&(this.setYaw(b,d,e,f),e=g);c!==g&&this.setHfov(c,d,e,f);return this};this.getNorthOffset=function(){return c.northOffset};this.setNorthOffset=function(a){c.northOffset=Math.min(360,Math.max(0,a));u();
return this};this.getHorizonRoll=function(){return c.horizonRoll};this.setHorizonRoll=function(a){c.horizonRoll=Math.min(90,Math.max(-90,a));A.setPose(c.horizonPitch*Math.PI/180,c.horizonRoll*Math.PI/180);u();return this};this.getHorizonPitch=function(){return c.horizonPitch};this.setHorizonPitch=function(a){c.horizonPitch=Math.min(90,Math.max(-90,a));A.setPose(c.horizonPitch*Math.PI/180,c.horizonRoll*Math.PI/180);u();return this};this.startAutoRotate=function(a){a=a||V||1;c.autoRotate=a;ra.lookAt(Aa,
g,oa,3E3);u();return this};this.stopAutoRotate=function(){V=c.autoRotate?c.autoRotate:V;c.autoRotate=!1;c.autoRotateInactivityDelay=-1;return this};this.getRenderer=function(){return A};this.setUpdate=function(a){Wa=!0===a;A===g?T():u();return this};this.mouseEventToCoords=function(a){return fa(a)};this.loadScene=function(a,b,c,d){H&&C(a,b,c,d);return this};this.getScene=function(){return c.scene};this.addScene=function(a,b){x.scenes[a]=b;return this};this.removeScene=function(a){if(c.scene===a||
!x.scenes.hasOwnProperty(a))return!1;delete x.scenes[a];return!0};this.toggleFullscreen=function(){ja();return this};this.getConfig=function(){return c};this.addHotSpot=function(a,d){if(d===g&&c.scene===g)c.hotSpots.push(a);else{var e=d!==g?d:c.scene;if(x.scenes.hasOwnProperty(e))x.scenes[e].hasOwnProperty("hotSpots")||(x.scenes[e].hotSpots=[],e==c.scene&&(c.hotSpots=x.scenes[e].hotSpots)),x.scenes[e].hotSpots.push(a);else throw"Invalid scene ID!";}if(d===g||c.scene==d)Ea(a),H&&b(a);return this};
this.removeHotSpot=function(a){if(!c.hotSpots)return!1;for(var b=0;b<c.hotSpots.length;b++)if(c.hotSpots[b].hasOwnProperty("id")&&c.hotSpots[b].id===a){for(a=c.hotSpots[b].div;a.parentNode!=I;)a=a.parentNode;I.removeChild(a);delete c.hotSpots[b].div;c.hotSpots.splice(b,1);return!0}return!1};this.resize=function(){y()};this.isLoaded=function(){return H};this.on=function(a,b){Q[a]=Q[a]||[];Q[a].push(b);return this};this.off=function(a,b){if(!a)return Q={},this;if(b){var c=Q[a].indexOf(b);0<=c&&Q[a].splice(c,
1);0==Q[a].length&&delete Q[a]}else delete Q[a];return this};this.destroy=function(){A&&A.destroy();Oa&&(E.removeEventListener("mousedown",ua,!1),E.removeEventListener("dblclick",wa,!1),l.removeEventListener("mousemove",xa,!1),l.removeEventListener("mouseup",ka,!1),m.removeEventListener("mousewheel",L,!1),m.removeEventListener("DOMMouseScroll",L,!1),m.removeEventListener("mozfullscreenchange",y,!1),m.removeEventListener("webkitfullscreenchange",y,!1),m.removeEventListener("msfullscreenchange",y,!1),
m.removeEventListener("fullscreenchange",y,!1),F.removeEventListener("resize",ga,!1),F.removeEventListener("orientationchange",ga,!1),m.removeEventListener("keydown",ya,!1),m.removeEventListener("keyup",ma,!1),m.removeEventListener("blur",S,!1),l.removeEventListener("mouseleave",ka,!1),E.removeEventListener("touchstart",ca,!1),E.removeEventListener("touchmove",la,!1),E.removeEventListener("touchend",w,!1),E.removeEventListener("pointerdown",d,!1),E.removeEventListener("pointermove",a,!1),E.removeEventListener("pointerup",
K,!1),E.removeEventListener("pointerleave",K,!1));m.innerHTML="";m.classList.remove("pnlm-container");m.classList.remove("pnlm-grab");m.classList.remove("pnlm-grabbing")}}return{viewer:function(g,l){return new ta(g,l)}}}(window,document);
