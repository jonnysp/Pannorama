// Pannellum 508a210, https://github.com/mpetroff/pannellum
window.libpannellum=function(I,f,m){function ua(P){function Za(a,e){return 1==a.level&&1!=e.level?-1:1==e.level&&1!=a.level?1:e.timestamp-a.timestamp}function W(a,e){return a.level!=e.level?a.level-e.level:a.diff-e.diff}function Q(a,e,d,f,p,b){this.vertices=a;this.side=e;this.level=d;this.x=f;this.y=p;this.path=b.replace("%s",e).replace("%l",d).replace("%x",f).replace("%y",p)}function va(a,e,f,m,p){var b;var g=e.vertices;b=ea(a,g.slice(0,3));var t=ea(a,g.slice(3,6)),z=ea(a,g.slice(6,9)),g=ea(a,g.slice(9,
12)),A=b[0]+t[0]+z[0]+g[0];-4==A||4==A?b=!1:(A=b[1]+t[1]+z[1]+g[1],b=-4==A||4==A?!1:4!=b[2]+t[2]+z[2]+g[2]);if(b){b=e.vertices;t=b[0]+b[3]+b[6]+b[9];z=b[1]+b[4]+b[7]+b[10];g=b[2]+b[5]+b[8]+b[11];A=Math.sqrt(t*t+z*z+g*g);g=Math.asin(g/A);t=Math.atan2(z,t)-m;t+=t>Math.PI?-2*Math.PI:t<-Math.PI?2*Math.PI:0;t=Math.abs(t);e.diff=Math.acos(Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos(t));t=!1;for(z=0;z<d.nodeCache.length;z++)if(d.nodeCache[z].path==e.path){t=!0;d.nodeCache[z].timestamp=d.nodeCacheTimestamp++;
d.nodeCache[z].diff=e.diff;d.currentNodes.push(d.nodeCache[z]);break}t||(e.timestamp=d.nodeCacheTimestamp++,d.currentNodes.push(e),d.nodeCache.push(e));if(e.level<d.level){var g=s.cubeResolution*Math.pow(2,e.level-s.maxLevel),t=Math.ceil(g*s.invTileResolution)-1,z=g%s.tileResolution*2,D=2*g%s.tileResolution;0===D&&(D=s.tileResolution);0===z&&(z=2*s.tileResolution);A=0.5;if(e.x==t||e.y==t)A=1-s.tileResolution/(s.tileResolution+D);var v=1-A,g=[],r=A,R=A,F=A,n=v,x=v,y=v;if(D<s.tileResolution)if(e.x==
t&&e.y!=t){if(x=R=0.5,"d"==e.side||"u"==e.side)y=F=0.5}else e.x!=t&&e.y==t&&(n=r=0.5,"l"==e.side||"r"==e.side)&&(y=F=0.5);z<=s.tileResolution&&(e.x==t&&(r=0,n=1,"l"==e.side||"r"==e.side)&&(F=0,y=1),e.y==t&&(R=0,x=1,"d"==e.side||"u"==e.side)&&(F=0,y=1));D=[b[0],b[1],b[2],b[0]*r+b[3]*n,b[1]*A+b[4]*v,b[2]*F+b[5]*y,b[0]*r+b[6]*n,b[1]*R+b[7]*x,b[2]*F+b[8]*y,b[0]*A+b[9]*v,b[1]*R+b[10]*x,b[2]*F+b[11]*y];D=new Q(D,e.side,e.level+1,2*e.x,2*e.y,s.fullpath);g.push(D);e.x==t&&z<=s.tileResolution||(D=[b[0]*r+
b[3]*n,b[1]*A+b[4]*v,b[2]*F+b[5]*y,b[3],b[4],b[5],b[3]*A+b[6]*v,b[4]*R+b[7]*x,b[5]*F+b[8]*y,b[0]*r+b[6]*n,b[1]*R+b[7]*x,b[2]*F+b[8]*y],D=new Q(D,e.side,e.level+1,2*e.x+1,2*e.y,s.fullpath),g.push(D));e.x==t&&z<=s.tileResolution||e.y==t&&z<=s.tileResolution||(D=[b[0]*r+b[6]*n,b[1]*R+b[7]*x,b[2]*F+b[8]*y,b[3]*A+b[6]*v,b[4]*R+b[7]*x,b[5]*F+b[8]*y,b[6],b[7],b[8],b[9]*r+b[6]*n,b[10]*A+b[7]*v,b[11]*F+b[8]*y],D=new Q(D,e.side,e.level+1,2*e.x+1,2*e.y+1,s.fullpath),g.push(D));e.y==t&&z<=s.tileResolution||(D=
[b[0]*A+b[9]*v,b[1]*R+b[10]*x,b[2]*F+b[11]*y,b[0]*r+b[6]*n,b[1]*R+b[7]*x,b[2]*F+b[8]*y,b[9]*r+b[6]*n,b[10]*A+b[7]*v,b[11]*F+b[8]*y,b[9],b[10],b[11]],D=new Q(D,e.side,e.level+1,2*e.x,2*e.y+1,s.fullpath),g.push(D));for(e=0;e<g.length;e++)va(a,g[e],f,m,p)}}}function xa(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function ha(a,e,d){var f=Math.sin(e);e=Math.cos(e);
if("x"==d)return[a[0],e*a[1]+f*a[2],e*a[2]-f*a[1],a[3],e*a[4]+f*a[5],e*a[5]-f*a[4],a[6],e*a[7]+f*a[8],e*a[8]-f*a[7]];if("y"==d)return[e*a[0]-f*a[2],a[1],e*a[2]+f*a[0],e*a[3]-f*a[5],a[4],e*a[5]+f*a[3],e*a[6]-f*a[8],a[7],e*a[8]+f*a[6]];if("z"==d)return[e*a[0]+f*a[1],e*a[1]-f*a[0],a[2],e*a[3]+f*a[4],e*a[4]-f*a[3],a[5],e*a[6]+f*a[7],e*a[7]-f*a[6],a[8]]}function ya(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]}function la(a){a.textureLoad||(a.textureLoad=
!0,Ha(encodeURI(a.path+"."+s.extension),function(e){a.texture=e;a.textureLoaded=!0}))}function ea(a,e){var d=[a[0]*e[0]+a[1]*e[1]+a[2]*e[2],a[4]*e[0]+a[5]*e[1]+a[6]*e[2],a[11]+a[8]*e[0]+a[9]*e[1]+a[10]*e[2],1/(a[12]*e[0]+a[13]*e[1]+a[14]*e[2])],f=d[0]*d[3],p=d[1]*d[3],d=d[2]*d[3],b=[0,0,0];-1>f&&(b[0]=-1);1<f&&(b[0]=1);-1>p&&(b[1]=-1);1<p&&(b[1]=1);if(-1>d||1<d)b[2]=1;return b}function ma(){console.log("Reducing canvas size due to error 1286!");v.width=Math.round(v.width/2);v.height=Math.round(v.height/
2)}var v=f.createElement("canvas");v.style.width=v.style.height="100%";P.appendChild(v);var d,a,M,N,za,S,na,$,s,y,ia,E,aa,oa,Y;this.init=function(k,e,Fa,da,p,b,g,t){typeof e===m&&(e="equirectangular");if("equirectangular"!=e&&"cubemap"!=e&&"multires"!=e)throw console.log("Error: invalid image type specified!"),{type:"config error"};y=e;s=k;ia=Fa;if(d){M&&(a.detachShader(d,M),a.deleteShader(M));N&&(a.detachShader(d,N),a.deleteShader(N));a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
null);d.texture&&a.deleteTexture(d.texture);if(d.nodeCache)for(k=0;k<d.nodeCache.length;k++)a.deleteTexture(d.nodeCache[k].texture);a.deleteProgram(d);d=m}$=m;"cubemap"==y&&0!==(s[0].width&s[0].width-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(a||(a=v.getContext("experimental-webgl",
{alpha:!1,depth:!1})),a&&1286==a.getError()&&ma());if(!a&&("multires"==y&&s.hasOwnProperty("fallbackPath")||"cubemap"==y)&&("WebkitAppearance"in f.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){S&&P.removeChild(S);S=f.createElement("div");S.className="pnlm-world";da=s.basePath?s.basePath+s.fallbackPath:s.fallbackPath;var z="frblud".split(""),A=0;p=function(){var a=f.createElement("canvas");a.className="pnlm-face pnlm-"+z[this.side]+
"face";S.appendChild(a);var b=a.getContext("2d");a.style.width=this.width+4+"px";a.style.height=this.height+4+"px";a.width=this.width+4;a.height=this.height+4;b.drawImage(this,2,2);var e=b.getImageData(0,0,a.width,a.height),d=e.data,k,n;for(k=2;k<a.width-2;k++)for(n=0;4>n;n++)d[4*(k+a.width)+n]=d[4*(k+2*a.width)+n],d[4*(k+a.width*(a.height-2))+n]=d[4*(k+a.width*(a.height-3))+n];for(k=2;k<a.height-2;k++)for(n=0;4>n;n++)d[4*(k*a.width+1)+n]=d[4*(k*a.width+2)+n],d[4*((k+1)*a.width-2)+n]=d[4*((k+1)*a.width-
3)+n];for(n=0;4>n;n++)d[4*(a.width+1)+n]=d[4*(2*a.width+2)+n],d[4*(2*a.width-2)+n]=d[4*(3*a.width-3)+n],d[4*(a.width*(a.height-2)+1)+n]=d[4*(a.width*(a.height-3)+2)+n],d[4*(a.width*(a.height-1)-2)+n]=d[4*(a.width*(a.height-2)-3)+n];for(k=1;k<a.width-1;k++)for(n=0;4>n;n++)d[4*k+n]=d[4*(k+a.width)+n],d[4*(k+a.width*(a.height-1))+n]=d[4*(k+a.width*(a.height-2))+n];for(k=1;k<a.height-1;k++)for(n=0;4>n;n++)d[k*a.width*4+n]=d[4*(k*a.width+1)+n],d[4*((k+1)*a.width-1)+n]=d[4*((k+1)*a.width-2)+n];for(n=0;4>
n;n++)d[n]=d[4*(a.width+1)+n],d[4*(a.width-1)+n]=d[4*(2*a.width-2)+n],d[a.width*(a.height-1)*4+n]=d[4*(a.width*(a.height-2)+1)+n],d[4*(a.width*a.height-1)+n]=d[4*(a.width*(a.height-1)-2)+n];b.putImageData(e,0,0);A++;6==A&&(za=this.width,P.appendChild(S),g())};for(k=0;6>k;k++)b=new Image,b.crossOrigin="anonymous",b.side=k,b.onload=p,b.src="multires"==y?encodeURI(da.replace("%s",z[k])+"."+s.extension):encodeURI(s[k].src)}else{if(!a)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};
s.fullpath=s.basePath?s.basePath+s.path:s.path;s.invTileResolution=1/s.tileResolution;e=xa();na=[];for(k=0;6>k;k++)na[k]=e.slice(12*k,12*k+12),e=xa();if("equirectangular"==y){if(k=Math.max(s.width,s.height),e=a.getParameter(a.MAX_TEXTURE_SIZE),k>e)throw console.log("Error: The image is too big; it's "+k+"px wide, but this device's maximum supported width is "+e+"px."),{type:"webgl size error",width:k,maxWidth:e};}else if("cubemap"==y&&(k=s[0].width,e=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),k>
e))throw console.log("Error: The cube face image is too big; it's "+k+"px wide, but this device's maximum supported width is "+e+"px."),{type:"webgl size error",width:k,maxWidth:e};t===m||t.horizonPitch===m&&t.horizonRoll===m||($=[t.horizonPitch==m?0:t.horizonPitch,t.horizonRoll==m?0:t.horizonRoll]);k=a.TEXTURE_2D;a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight);M=a.createShader(a.VERTEX_SHADER);e=r;"multires"==y&&(e=x);a.shaderSource(M,e);a.compileShader(M);N=a.createShader(a.FRAGMENT_SHADER);
e=Ia;"cubemap"==y?(k=a.TEXTURE_CUBE_MAP,e=Ja):"multires"==y&&(e=ja);a.shaderSource(N,e);a.compileShader(N);d=a.createProgram();a.attachShader(d,M);a.attachShader(d,N);a.linkProgram(d);a.getShaderParameter(M,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(M));a.getShaderParameter(N,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(N));a.getProgramParameter(d,a.LINK_STATUS)||console.log(a.getProgramInfoLog(d));a.useProgram(d);d.drawInProgress=!1;d.texCoordLocation=a.getAttribLocation(d,"a_texCoord");
a.enableVertexAttribArray(d.texCoordLocation);"multires"!=y?(E||(E=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,E),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),a.STATIC_DRAW),a.vertexAttribPointer(d.texCoordLocation,2,a.FLOAT,!1,0,0),d.aspectRatio=a.getUniformLocation(d,"u_aspectRatio"),a.uniform1f(d.aspectRatio,v.clientWidth/v.clientHeight),d.psi=a.getUniformLocation(d,"u_psi"),d.theta=a.getUniformLocation(d,"u_theta"),d.f=a.getUniformLocation(d,"u_f"),d.h=a.getUniformLocation(d,
"u_h"),d.v=a.getUniformLocation(d,"u_v"),d.vo=a.getUniformLocation(d,"u_vo"),d.rot=a.getUniformLocation(d,"u_rot"),a.uniform1f(d.h,da/(2*Math.PI)),a.uniform1f(d.v,p/Math.PI),a.uniform1f(d.vo,b/Math.PI*2),"equirectangular"==y&&(d.backgroundColor=a.getUniformLocation(d,"u_backgroundColor"),a.uniform4fv(d.backgroundColor,(t.backgroundColor?t.backgroundColor:[0,0,0]).concat([1]))),d.texture=a.createTexture(),a.bindTexture(k,d.texture),"cubemap"==y?(a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,a.RGB,a.RGB,
a.UNSIGNED_BYTE,s[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s[5]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s[2])):a.texImage2D(k,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,s),a.texParameteri(k,a.TEXTURE_WRAP_S,
a.CLAMP_TO_EDGE),a.texParameteri(k,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(k,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(k,a.TEXTURE_MAG_FILTER,a.LINEAR)):(d.vertPosLocation=a.getAttribLocation(d,"a_vertCoord"),a.enableVertexAttribArray(d.vertPosLocation),aa||(aa=a.createBuffer()),oa||(oa=a.createBuffer()),Y||(Y=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,oa),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,Y),a.bufferData(a.ELEMENT_ARRAY_BUFFER,
new Uint16Array([0,1,2,0,2,3]),a.STATIC_DRAW),d.perspUniform=a.getUniformLocation(d,"u_perspMatrix"),d.cubeUniform=a.getUniformLocation(d,"u_cubeMatrix"),d.level=-1,d.currentNodes=[],d.nodeCache=[],d.nodeCacheTimestamp=0);da=a.getError();if(0!==da)throw console.log("Error: Something went wrong with WebGL!",da),{type:"webgl error"};g()}};this.destroy=function(){P!==m&&(v!==m&&P.contains(v)&&P.removeChild(v),S!==m&&P.contains(S)&&P.removeChild(S));if(a){var d=a.getExtension("WEBGL_lose_context");d&&
d.loseContext()}};this.resize=function(){var k=I.devicePixelRatio||1;v.width=v.clientWidth*k;v.height=v.clientHeight*k;a&&(1286==a.getError()&&ma(),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),"multires"!=y&&a.uniform1f(d.aspectRatio,v.clientWidth/v.clientHeight))};this.resize();this.setPose=function(a,d){$=[a,d]};this.render=function(k,e,f,r){var p;p=0;r===m&&(r={});r.roll&&(p=r.roll);if($!==m){var b=$[0],g=$[1],t=k,z=e,x=Math.cos(g)*Math.sin(k)*Math.sin(b)+Math.cos(k)*(Math.cos(b)*
Math.cos(e)+Math.sin(g)*Math.sin(b)*Math.sin(e)),D=-Math.sin(k)*Math.sin(g)+Math.cos(k)*Math.cos(g)*Math.sin(e);k=Math.cos(g)*Math.cos(b)*Math.sin(k)+Math.cos(k)*(-Math.cos(e)*Math.sin(b)+Math.cos(b)*Math.sin(g)*Math.sin(e));k=Math.asin(Math.max(Math.min(k,1),-1));e=Math.atan2(D,x);b=[Math.cos(t)*(Math.sin(g)*Math.sin(b)*Math.cos(z)-Math.cos(b)*Math.sin(z)),Math.cos(t)*Math.cos(g)*Math.cos(z),Math.cos(t)*(Math.cos(b)*Math.sin(g)*Math.cos(z)+Math.sin(z)*Math.sin(b))];g=[-Math.cos(k)*Math.sin(e),Math.cos(k)*
Math.cos(e)];g=Math.acos(Math.max(Math.min((b[0]*g[0]+b[1]*g[1])/(Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])*Math.sqrt(g[0]*g[0]+g[1]*g[1])),1),-1));0>b[2]&&(g=2*Math.PI-g);p+=g}if(a||"multires"!=y&&"cubemap"!=y){if("multires"!=y)f=2*Math.atan(Math.tan(0.5*f)/(v.clientWidth/v.clientHeight)),f=1/Math.tan(0.5*f),a.uniform1f(d.psi,e),a.uniform1f(d.theta,k),a.uniform1f(d.rot,p),a.uniform1f(d.f,f),!0===ia&&"equirectangular"==y&&(a.bindTexture(a.TEXTURE_2D,d.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,
a.UNSIGNED_BYTE,s)),a.drawArrays(a.TRIANGLES,0,6);else{b=v.clientWidth/v.clientHeight;g=2*Math.atan(Math.tan(f/2)*v.clientHeight/v.clientWidth);g=1/Math.tan(g/2);b=[g/b,0,0,0,0,g,0,0,0,0,100.1/-99.9,20/-99.9,0,0,-1,0];for(g=1;g<s.maxLevel&&v.width>s.tileResolution*Math.pow(2,g-1)*Math.tan(f/2)*0.707;)g++;d.level=g;g=[1,0,0,0,1,0,0,0,1];g=ha(g,-p,"z");g=ha(g,-k,"x");g=ha(g,e,"y");g=[g[0],g[1],g[2],0,g[3],g[4],g[5],0,g[6],g[7],g[8],0,0,0,0,1];a.uniformMatrix4fv(d.perspUniform,!1,new Float32Array(ya(b)));
a.uniformMatrix4fv(d.cubeUniform,!1,new Float32Array(ya(g)));b=[b[0]*g[0],b[0]*g[1],b[0]*g[2],0,b[5]*g[4],b[5]*g[5],b[5]*g[6],0,b[10]*g[8],b[10]*g[9],b[10]*g[10],b[11],-g[8],-g[9],-g[10],0];d.nodeCache.sort(Za);if(200<d.nodeCache.length&&d.nodeCache.length>d.currentNodes.length+50)for(g=d.nodeCache.splice(200,d.nodeCache.length-200),p=0;p<g.length;p++)a.deleteTexture(g[p].texture);d.currentNodes=[];g="fbudlr".split("");for(p=0;6>p;p++)t=new Q(na[p],g[p],1,0,0,s.fullpath),va(b,t,k,e,f);d.currentNodes.sort(W);
for(p=0;p<d.currentNodes.length;p++)if(!d.currentNodes[p].texture){setTimeout(la,0,d.currentNodes[p]);break}if(!d.drawInProgress){d.drawInProgress=!0;for(k=0;k<d.currentNodes.length;k++)d.currentNodes[k].textureLoaded&&(a.bindBuffer(a.ARRAY_BUFFER,aa),a.bufferData(a.ARRAY_BUFFER,new Float32Array(d.currentNodes[k].vertices),a.STATIC_DRAW),a.vertexAttribPointer(d.vertPosLocation,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,oa),a.vertexAttribPointer(d.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,
d.currentNodes[k].texture),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0));d.drawInProgress=!1}}if(r.returnImage!==m)return v.toDataURL("image/png")}else for(p=za/2,r={f:"translate3d(-"+(p+2)+"px, -"+(p+2)+"px, -"+p+"px)",b:"translate3d("+(p+2)+"px, -"+(p+2)+"px, "+p+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(p+2)+"px, -"+p+"px, "+(p+2)+"px) rotateX(270deg)",d:"translate3d(-"+(p+2)+"px, "+p+"px, -"+(p+2)+"px) rotateX(90deg)",l:"translate3d(-"+p+"px, -"+(p+2)+"px, "+(p+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",
r:"translate3d("+p+"px, -"+(p+2)+"px, -"+(p+2)+"px) rotateY(270deg)"},f=1/Math.tan(f/2),f=f*v.clientWidth/2+"px",k="perspective("+f+") translateZ("+f+") rotateX("+k+"rad) rotateY("+e+"rad) ",e=Object.keys(r),p=0;6>p;p++)f=S.querySelector(".pnlm-"+e[p]+"face").style,f.webkitTransform=k+r[e[p]],f.transform=k+r[e[p]]};this.isLoading=function(){if(a&&"multires"==y)for(var f=0;f<d.currentNodes.length;f++)if(!d.currentNodes[f].textureLoaded)return!0;return!1};this.getCanvas=function(){return v};var Ha=
function(){function d(){var b=this;this.texture=this.callback=null;this.image=new Image;this.image.crossOrigin="anonymous";this.image.addEventListener("load",function(){var d=b.image;a.bindTexture(a.TEXTURE_2D,b.texture);a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,
a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);b.callback(b.texture);p.length?(d=p.shift(),b.loadTexture(d.src,d.texture,d.callback)):m[f++]=b})}function e(a,b,d){this.src=a;this.texture=b;this.callback=d}var f=4,m={},p=[];d.prototype.loadTexture=function(a,b,d){this.texture=b;this.callback=d;this.image.src=a};for(var b=0;b<f;b++)m[b]=new d;return function(b,d){var k=a.createTexture();f?m[--f].loadTexture(b,k,d):p.push(new e(b,k,d));return k}}()}var r="attribute vec2 a_texCoord;varying vec2 v_texCoord;void main() {gl_Position = vec4(a_texCoord, 0.0, 1.0);v_texCoord = a_texCoord;}",
x="attribute vec3 a_vertCoord;attribute vec2 a_texCoord;uniform mat4 u_cubeMatrix;uniform mat4 u_perspMatrix;varying mediump vec2 v_texCoord;void main(void) {gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);v_texCoord = a_texCoord;}",Ja="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);float cosphi = cos(phi);\ngl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\n}",
Ia="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);lambda = mod(lambda + PI, PI * 2.0) - PI;\nvec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\nif(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\ngl_FragColor = u_backgroundColor;\nelse\ngl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\n}",
ja="varying mediump vec2 v_texCoord;uniform sampler2D u_sampler;void main(void) {gl_FragColor = texture2D(u_sampler, v_texCoord);}";return{renderer:function(f,m,r,x){return new ua(f,m,r,x)}}}(window,document);window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(I,f){window.setTimeout(I,1E3/60)}}());
window.pannellum=function(I,f,m){function ua(r,x){function Ja(a){I.removeEventListener("deviceorientation",Ja);a&&null!==a.alpha&&null!==a.beta&&null!==a.gamma?(u.container.appendChild(u.orientation),Aa=!0,Va&&Oa()):Aa=!1}function Ia(){var a=f.createElement("div");a.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e";if(1==a.getElementsByTagName("i").length)W();else{pa=c.hfov;Ba=c.pitch;var h;if("cubemap"==c.type){O=[];for(a=0;6>a;a++)O.push(new Image),O[a].crossOrigin="anonymous";q.load.lbox.style.display=
"block";q.load.lbar.style.display="none"}else if("multires"==c.type)a=JSON.parse(JSON.stringify(c.multiRes)),c.basePath&&c.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(c.multiRes.basePath)?a.basePath=c.basePath+c.multiRes.basePath:c.multiRes.basePath?a.basePath=c.multiRes.basePath:c.basePath&&(a.basePath=c.basePath),O=a;else if(!0===c.dynamic)O=c.panorama;else{if(c.panorama===m){W("No panorama image was specified.");return}O=new Image}if("cubemap"==c.type)for(var b=6,d=function(){b--;0===b&&P()},
e=function(a){var G=f.createElement("a");G.href=a.target.src;G.innerHTML=G.href;W("The file "+G.outerHTML+" could not be accessed.")},a=0;a<O.length;a++)O[a].onload=d,O[a].onerror=e,h=c.cubeMap[a],c.basePath&&!ja(h)&&(h=c.basePath+h),O[a].src=encodeURI(h);else if("multires"==c.type)P();else if(h="",c.basePath&&(h=c.basePath),!0!==c.dynamic){h=ja(c.panorama)?c.panorama:h+c.panorama;O.onload=function(){I.URL.revokeObjectURL(this.src);P()};var g=new XMLHttpRequest;g.onloadend=function(){if(200!=g.status){var a=
f.createElement("a");a.href=encodeURI(h);a.innerHTML=a.href;W("The file "+a.outerHTML+" could not be accessed.")}ua(this.response);q.load.msg.innerHTML=""};g.onprogress=function(a){if(a.lengthComputable){q.load.lbarFill.style.width=a.loaded/a.total*100+"%";var G,c;1E6<a.total?(G="MB",c=(a.loaded/1E6).toFixed(2),a=(a.total/1E6).toFixed(2)):1E3<a.total?(G="kB",c=(a.loaded/1E3).toFixed(1),a=(a.total/1E3).toFixed(1)):(G="B",c=a.loaded,a=a.total);q.load.msg.innerHTML=c+" / "+a+" "+G}else q.load.lbox.style.display=
"block",q.load.lbar.style.display="none"};try{g.open("GET",h,!0)}catch(k){W("There is something wrong with the panorama URL.")}g.responseType="blob";g.setRequestHeader("Accept","image/*,*/*;q=0.9");g.send()}B.classList.add("pnlm-grab");B.classList.remove("pnlm-grabbing")}}function ja(a){return/^(?:[a-z]+:)?\/\//i.test(a)||"/"==a[0]||"blob:"==a.slice(0,5)}function P(){C||(C=new libpannellum.renderer(L));Pa||(Pa=!0,H.addEventListener("mousedown",va,!1),f.addEventListener("mousemove",ya,!1),f.addEventListener("mouseup",
la,!1),c.mouseZoom&&(B.addEventListener("mousewheel",N,!1),B.addEventListener("DOMMouseScroll",N,!1)),c.doubleClickZoom&&H.addEventListener("dblclick",xa,!1),B.addEventListener("mozfullscreenchange",A,!1),B.addEventListener("webkitfullscreenchange",A,!1),B.addEventListener("msfullscreenchange",A,!1),B.addEventListener("fullscreenchange",A,!1),I.addEventListener("resize",ia,!1),I.addEventListener("orientationchange",ia,!1),B.addEventListener("keydown",za,!1),B.addEventListener("keyup",na,!1),B.addEventListener("blur",
S,!1),f.addEventListener("mouseleave",la,!1),H.addEventListener("touchstart",ea,!1),H.addEventListener("touchmove",ma,!1),H.addEventListener("touchend",v,!1),H.addEventListener("pointerdown",d,!1),H.addEventListener("pointermove",a,!1),H.addEventListener("pointerup",M,!1),H.addEventListener("pointerleave",M,!1),I.navigator.pointerEnabled&&(r.style.touchAction="none"));k();setTimeout(function(){},500)}function ua(a){var h=new FileReader;h.addEventListener("loadend",function(){var b=h.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var d=
b.indexOf("\u00ff\u00c2");(0>d||65536<d)&&W("Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).")}d=b.indexOf("<x:xmpmeta");if(-1<d&&!0!==c.ignoreGPanoXMP){var e=b.substring(d,b.indexOf("</x:xmpmeta>")+12),f=function(a){var G;0<=e.indexOf(a+'="')?(G=e.substring(e.indexOf(a+'="')+a.length+2),G=G.substring(0,G.indexOf('"'))):0<=e.indexOf(a+">")&&(G=e.substring(e.indexOf(a+">")+a.length+1),G=G.substring(0,G.indexOf("<")));
return G!==m?Number(G):null},b=f("GPano:FullPanoWidthPixels"),d=f("GPano:CroppedAreaImageWidthPixels"),g=f("GPano:FullPanoHeightPixels"),k=f("GPano:CroppedAreaImageHeightPixels"),n=f("GPano:CroppedAreaTopPixels"),p=f("GPano:PoseHeadingDegrees"),l=f("GPano:PosePitchDegrees"),f=f("GPano:PoseRollDegrees");null!==b&&null!==d&&null!==g&&null!==k&&null!==n&&(0>Z.indexOf("haov")&&(c.haov=d/b*360),0>Z.indexOf("vaov")&&(c.vaov=k/g*180),0>Z.indexOf("vOffset")&&(c.vOffset=-180*((n+k/2)/g-0.5)),null!==p&&0>Z.indexOf("northOffset")&&
(c.northOffset=p,!1!==c.compass&&(c.compass=!0)),null!==l&&null!==f&&(0>Z.indexOf("horizonPitch")&&(c.horizonPitch=l),0>Z.indexOf("horizonRoll")&&(c.horizonRoll=f)))}O.src=I.URL.createObjectURL(a)});h.readAsBinaryString!==m?h.readAsBinaryString(a):h.readAsText(a)}function W(a){a===m&&(a="Your browser does not have the necessary WebGL support to display this panorama.");q.errorMsg.innerHTML="<p>"+a+"</p>";u.load.style.display="none";q.load.box.style.display="none";q.errorMsg.style.display="table";
Ka=!0;L.style.display="none";ba("error",a)}function Q(a){var c=r.getBoundingClientRect(),b={};b.x=a.clientX-c.left;b.y=a.clientY-c.top;return b}function va(a){a.preventDefault();r.focus();if(K&&c.draggable){var h=Q(a);if(c.hotSpotDebug){var b=ha(a);console.log("Pitch: "+b[0]+", Yaw: "+b[1]+", Center Pitch: "+c.pitch+", Center Yaw: "+c.yaw+", HFOV: "+c.hfov)}Ga();n();c.roll=0;w.hfov=0;fa=!0;T=Date.now();qa=h.x;ra=h.y;La=c.yaw;Ma=c.pitch;B.classList.add("pnlm-grabbing");B.classList.remove("pnlm-grab");
ba("mousedown",a);E()}}function xa(a){c.minHfov===c.hfov?sa.setHfov(pa,1E3):(a=ha(a),sa.lookAt(a[0],a[1],c.minHfov,1E3))}function ha(a){var h=Q(a);a=C.getCanvas();var b=a.clientWidth,d=a.clientHeight;a=h.x/b*2-1;var d=(1-h.y/d*2)*d/b,e=1/Math.tan(c.hfov*Math.PI/360),f=Math.sin(c.pitch*Math.PI/180),g=Math.cos(c.pitch*Math.PI/180),h=e*g-d*f,b=Math.sqrt(a*a+h*h),d=180*Math.atan((d*g+e*f)/b)/Math.PI;a=180*Math.atan2(a/b,h/b)/Math.PI+c.yaw;-180>a&&(a+=360);180<a&&(a-=360);return[d,a]}function ya(a){if(fa&&
K){T=Date.now();var h=C.getCanvas(),b=h.clientWidth,h=h.clientHeight;a=Q(a);var d=180*(Math.atan(qa/b*2-1)-Math.atan(a.x/b*2-1))/Math.PI*c.hfov/90+La;w.yaw=(d-c.yaw)%360*0.2;c.yaw=d;b=360*Math.atan(Math.tan(c.hfov/360*Math.PI)*h/b)/Math.PI;b=180*(Math.atan(a.y/h*2-1)-Math.atan(ra/h*2-1))/Math.PI*b/90+Ma;w.pitch=0.2*(b-c.pitch);c.pitch=b}}function la(a){fa&&(fa=!1,15<Date.now()-T&&(w.pitch=w.yaw=0),B.classList.add("pnlm-grab"),B.classList.remove("pnlm-grabbing"),T=Date.now(),ba("mouseup",a))}function ea(a){if(K&&
c.draggable){Ga();n();c.roll=0;w.hfov=0;var h=Q(a.targetTouches[0]);qa=h.x;ra=h.y;if(2==a.targetTouches.length){var b=Q(a.targetTouches[1]);qa+=0.5*(b.x-h.x);ra+=0.5*(b.y-h.y);Ca=Math.sqrt((h.x-b.x)*(h.x-b.x)+(h.y-b.y)*(h.y-b.y))}fa=!0;T=Date.now();La=c.yaw;Ma=c.pitch;ba("touchstart",a);E()}}function ma(a){if(c.draggable&&(a.preventDefault(),K&&(T=Date.now()),fa&&K)){var h=Q(a.targetTouches[0]),b=h.x,d=h.y;2==a.targetTouches.length&&-1!=Ca&&(a=Q(a.targetTouches[1]),b+=0.5*(a.x-h.x),d+=0.5*(a.y-h.y),
h=Math.sqrt((h.x-a.x)*(h.x-a.x)+(h.y-a.y)*(h.y-a.y)),V(c.hfov+0.1*(Ca-h)),Ca=h);h=c.hfov/360;b=(qa-b)*h+La;w.yaw=(b-c.yaw)%360*0.2;c.yaw=b;d=(d-ra)*h+Ma;w.pitch=0.2*(d-c.pitch);c.pitch=d}}function v(){fa=!1;150<Date.now()-T&&(w.pitch=w.yaw=0);Ca=-1;T=Date.now();ba("touchend",event)}function d(a){"touch"==a.pointerType&&(ga.push(a.pointerId),ta.push({clientX:a.clientX,clientY:a.clientY}),a.targetTouches=ta,ea(a),a.preventDefault())}function a(a){if("touch"==a.pointerType)for(var c=0;c<ga.length;c++)if(a.pointerId==
ga[c]){ta[c].clientX=a.clientX;ta[c].clientY=a.clientY;a.targetTouches=ta;ma(a);break}}function M(a){if("touch"==a.pointerType){for(var c=!1,b=0;b<ga.length;b++)a.pointerId==ga[b]&&(ga[b]=m),ga[b]&&(c=!0);c||(ga=[],ta=[],v());a.preventDefault()}}function N(a){K&&("fullscreenonly"!=c.mouseZoom||Da)&&(a.preventDefault(),Ga(),T=Date.now(),a.wheelDeltaY?(V(c.hfov-0.05*a.wheelDeltaY),w.hfov=0>a.wheelDelta?1:-1):a.wheelDelta?(V(c.hfov-0.05*a.wheelDelta),w.hfov=0>a.wheelDelta?1:-1):a.detail&&(V(c.hfov+1.5*
a.detail),w.hfov=0<a.detail?1:-1),E())}function za(a){Ga();T=Date.now();n();c.roll=0;var h=a.which||a.keycode;0>Wa.indexOf(h)||(a.preventDefault(),27==h?Da&&z():$(h,!0))}function S(){for(var a=0;10>a;a++)l[a]=!1}function na(a){var c=a.which||a.keycode;0>Wa.indexOf(c)||(a.preventDefault(),$(c,!1))}function $(a,c){var b=!1;switch(a){case 109:case 189:case 17:case 173:l[0]!=c&&(b=!0);l[0]=c;break;case 107:case 187:case 16:case 61:l[1]!=c&&(b=!0);l[1]=c;break;case 38:l[2]!=c&&(b=!0);l[2]=c;break;case 87:l[6]!=
c&&(b=!0);l[6]=c;break;case 40:l[3]!=c&&(b=!0);l[3]=c;break;case 83:l[7]!=c&&(b=!0);l[7]=c;break;case 37:l[4]!=c&&(b=!0);l[4]=c;break;case 65:l[8]!=c&&(b=!0);l[8]=c;break;case 39:l[5]!=c&&(b=!0);l[5]=c;break;case 68:l[9]!=c&&(b=!0),l[9]=c}b&&c&&(ca="undefined"!==typeof performance&&performance.now()?performance.now():Date.now(),E())}function s(){if(K){var a=!1,h=c.pitch,b=c.yaw,d=c.hfov,e;e="undefined"!==typeof performance&&performance.now()?performance.now():Date.now();ca===m&&(ca=e);var f=(e-ca)*
c.hfov/1700,f=Math.min(f,1);l[0]&&!0===c.keyboardZoom&&(V(c.hfov+(0.8*w.hfov+0.5)*f),a=!0);l[1]&&!0===c.keyboardZoom&&(V(c.hfov+(0.8*w.hfov-0.2)*f),a=!0);if(l[2]||l[6])c.pitch+=(0.8*w.pitch+0.2)*f,a=!0;if(l[3]||l[7])c.pitch+=(0.8*w.pitch-0.2)*f,a=!0;if(l[4]||l[8])c.yaw+=(0.8*w.yaw-0.2)*f,a=!0;if(l[5]||l[9])c.yaw+=(0.8*w.yaw+0.2)*f,a=!0;a&&(T=Date.now());Date.now();if(c.autoRotate){if(0.001<e-ca){var a=(e-ca)/1E3,g=(w.yaw/a*f-0.2*c.autoRotate)*a,g=(0<-c.autoRotate?1:-1)*Math.min(Math.abs(c.autoRotate*
a),Math.abs(g));c.yaw+=g}c.autoRotateStopDelay&&(c.autoRotateStopDelay-=e-ca,0>=c.autoRotateStopDelay&&(c.autoRotateStopDelay=!1,X=c.autoRotate,c.autoRotate=0))}J.pitch&&(y("pitch"),h=c.pitch);J.yaw&&(y("yaw"),b=c.yaw);J.hfov&&(y("hfov"),d=c.hfov);0<f&&!c.autoRotate&&(l[4]||l[5]||l[8]||l[9]||J.yaw||(c.yaw+=w.yaw*f*0.85),l[2]||l[3]||l[6]||l[7]||J.pitch||(c.pitch+=w.pitch*f*0.85),l[0]||l[1]||J.hfov||V(c.hfov+w.hfov*f*0.85));ca=e;0<f&&(w.yaw=0.8*w.yaw+(c.yaw-b)/f*0.2,w.pitch=0.8*w.pitch+(c.pitch-h)/
f*0.2,w.hfov=0.8*w.hfov+(c.hfov-d)/f*0.2,h=c.autoRotate?Math.abs(c.autoRotate):5,w.yaw=Math.min(h,Math.max(w.yaw,-h)),w.pitch=Math.min(h,Math.max(w.pitch,-h)),w.hfov=Math.min(h,Math.max(w.hfov,-h)));l[0]&&l[0]&&(w.hfov=0);(l[2]||l[6])&&(l[3]||l[7])&&(w.pitch=0);(l[4]||l[8])&&(l[5]||l[9])&&(w.yaw=0)}}function y(a){var h=J[a],b=Math.min(1,Math.max((Date.now()-h.startTime)/1E3/(h.duration/1E3),0)),b=h.startPosition+c.animationTimingFunction(b)*(h.endPosition-h.startPosition);if(h.endPosition>h.startPosition&&
b>=h.endPosition||h.endPosition<h.startPosition&&b<=h.endPosition||h.endPosition===h.startPosition){b=h.endPosition;w[a]=0;var h=J[a].callback,d=J[a].callbackArgs;delete J[a];"function"==typeof h&&h(d)}c[a]=b}function ia(){A()}function E(){Qa||(Qa=!0,aa())}function aa(){oa();Ra&&clearTimeout(Ra);if(fa||Na)requestAnimationFrame(aa);else if(l[0]||l[1]||l[2]||l[3]||l[4]||l[5]||l[6]||l[7]||l[8]||l[9]||c.autoRotate||J.pitch||J.yaw||J.hfov||0.01<Math.abs(w.yaw)||0.01<Math.abs(w.pitch)||0.01<Math.abs(w.hfov))s(),
0<=c.autoRotateInactivityDelay&&X&&Date.now()-T>c.autoRotateInactivityDelay&&!c.autoRotate&&(c.autoRotate=X,sa.lookAt(Ba,m,pa,3E3)),requestAnimationFrame(aa);else if(C&&(C.isLoading()||!0===c.dynamic&&Xa))requestAnimationFrame(aa);else{Qa=!1;ca=m;var a=c.autoRotateInactivityDelay-(Date.now()-T);0<a?Ra=setTimeout(function(){c.autoRotate=X;sa.lookAt(Ba,m,pa,3E3);E()},a):0<=c.autoRotateInactivityDelay&&X&&(c.autoRotate=X,sa.lookAt(Ba,m,pa,3E3),E())}}function oa(){var a;if(K){180<c.yaw?c.yaw-=360:-180>
c.yaw&&(c.yaw+=360);a=c.yaw;var h=c.maxYaw-c.minYaw,d=-180,e=180;360>h&&(d=c.minYaw+c.hfov/2,e=c.maxYaw-c.hfov/2,h<c.hfov&&(d=e=(d+e)/2));c.yaw=Math.max(d,Math.min(e,c.yaw));!1!==c.autoRotate&&a!=c.yaw&&(c.autoRotate*=-1);a=C.getCanvas();a=2*Math.atan(Math.tan(c.hfov/180*Math.PI*0.5)/(a.width/a.height))/Math.PI*180;h=c.minPitch+a/2;d=c.maxPitch-a/2;c.maxPitch-c.minPitch<a&&(h=d=(h+d)/2);isNaN(h)&&(h=-90);isNaN(d)&&(d=90);c.pitch=Math.max(h,Math.min(d,c.pitch));C.render(c.pitch*Math.PI/180,c.yaw*Math.PI/
180,c.hfov*Math.PI/180,{roll:c.roll*Math.PI/180});c.hotSpots.forEach(b);c.compass&&(Ea.style.transform="rotate("+(-c.yaw-c.northOffset)+"deg)",Ea.style.webkitTransform="rotate("+(-c.yaw-c.northOffset)+"deg)")}}function Y(a,c,b,d){this.w=a;this.x=c;this.y=b;this.z=d}function Ha(a){var h;h=a.alpha;var b=a.beta;a=a.gamma;b=[b?b*Math.PI/180/2:0,a?a*Math.PI/180/2:0,h?h*Math.PI/180/2:0];h=[Math.cos(b[0]),Math.cos(b[1]),Math.cos(b[2])];b=[Math.sin(b[0]),Math.sin(b[1]),Math.sin(b[2])];h=new Y(h[0]*h[1]*h[2]-
b[0]*b[1]*b[2],b[0]*h[1]*h[2]-h[0]*b[1]*b[2],h[0]*b[1]*h[2]+b[0]*h[1]*b[2],h[0]*h[1]*b[2]+b[0]*b[1]*h[2]);h=h.multiply(new Y(Math.sqrt(0.5),-Math.sqrt(0.5),0,0));b=I.orientation?-I.orientation*Math.PI/180/2:0;h=h.multiply(new Y(Math.cos(b),0,-Math.sin(b),0)).toEulerAngles();c.pitch=h[0]/Math.PI*180;c.roll=-h[1]/Math.PI*180;c.yaw=-h[2]/Math.PI*180+c.northOffset+Ya}function k(){try{var a={};c.horizonPitch!==m&&(a.horizonPitch=c.horizonPitch*Math.PI/180);c.horizonRoll!==m&&(a.horizonRoll=c.horizonRoll*
Math.PI/180);c.backgroundColor!==m&&(a.backgroundColor=c.backgroundColor);C.init(O,c.type,c.dynamic,c.haov*Math.PI/180,c.vaov*Math.PI/180,c.vOffset*Math.PI/180,e,a);!0!==c.dynamic&&(O=m)}catch(b){if("webgl error"==b.type||"no webgl"==b.type)W();else if("webgl size error"==b.type)W("This panorama is too big for your device! It's "+b.width+"px wide, but your device only supports images up to "+b.maxWidth+"px wide. Try another device. (If you're the author, try scaling down the image.)");else throw W("Unknown error. Check developer console."),
b;}}function e(){if(c.sceneFadeDuration&&C.fadeImg!==m){C.fadeImg.style.opacity=0;var a=C.fadeImg;delete C.fadeImg;setTimeout(function(){L.removeChild(a);ba("scenechangefadedone")},c.sceneFadeDuration)}Ea.style.display=c.compass?"inline":"none";da();q.load.box.style.display="none";ka!==m&&(L.removeChild(ka),ka=m);K=!0;ba("load");E()}function Fa(a){a.pitch=Number(a.pitch)||0;a.yaw=Number(a.yaw)||0;var b=f.createElement("div");b.className="pnlm-hotspot-base";b.className=a.cssClass?b.className+(" "+
a.cssClass):b.className+(" pnlm-hotspot pnlm-sprite pnlm-"+wa(a.type));var d=f.createElement("span");a.text&&(d.innerHTML=wa(a.text));var e;if(a.video){e=f.createElement("video");var g=a.video;c.basePath&&!ja(g)&&(g=c.basePath+g);e.src=encodeURI(g);e.controls=!0;e.style.width=a.width+"px";L.appendChild(b);d.appendChild(e)}else if(a.image){g=a.image;c.basePath&&!ja(g)&&(g=c.basePath+g);e=f.createElement("a");e.href=encodeURI(a.URL?a.URL:g);e.target="_blank";d.appendChild(e);var k=f.createElement("img");
k.src=encodeURI(g);k.style.width=a.width+"px";k.style.paddingTop="5px";L.appendChild(b);e.appendChild(k);d.style.maxWidth="initial"}else a.URL?(e=f.createElement("a"),e.href=encodeURI(a.URL),e.target="_blank",L.appendChild(e),b.style.cursor="pointer",d.style.cursor="pointer",e.appendChild(b)):(a.sceneId&&(b.onclick=b.ontouchend=function(){b.clicked||(b.clicked=!0,F(a.sceneId,a.targetPitch,a.targetYaw,a.targetHfov));return!1},b.style.cursor="pointer",d.style.cursor="pointer"),L.appendChild(b));if(a.createTooltipFunc)a.createTooltipFunc(b,
a.createTooltipArgs);else if(a.text||a.video||a.image)b.classList.add("pnlm-tooltip"),b.appendChild(d),d.style.width=d.scrollWidth-20+"px",d.style.marginLeft=-(d.scrollWidth-b.offsetWidth)/2+"px",d.style.marginTop=-d.scrollHeight-12+"px";a.clickHandlerFunc&&(b.addEventListener("click",function(c){a.clickHandlerFunc(c,a.clickHandlerArgs)},"false"),b.style.cursor="pointer",d.style.cursor="pointer");a.div=b}function da(){Sa||(c.hotSpots?(c.hotSpots=c.hotSpots.sort(function(a,c){return a.pitch<c.pitch}),
c.hotSpots.forEach(Fa)):c.hotSpots=[],Sa=!0,c.hotSpots.forEach(b))}function p(){var a=c.hotSpots;Sa=!1;delete c.hotSpots;if(a)for(var b=0;b<a.length;b++){for(var d=a[b].div;d.parentNode!=L;)d=d.parentNode;L.removeChild(d);delete a.div}}function b(a){var b=Math.sin(a.pitch*Math.PI/180),d=Math.cos(a.pitch*Math.PI/180),e=Math.sin(c.pitch*Math.PI/180),f=Math.cos(c.pitch*Math.PI/180),g=Math.cos((-a.yaw+c.yaw)*Math.PI/180),k=b*e+d*g*f;if(90>=a.yaw&&-90<a.yaw&&0>=k||(90<a.yaw||-90>=a.yaw)&&0>=k)a.div.style.visibility=
"hidden";else{var n=Math.sin((-a.yaw+c.yaw)*Math.PI/180),p=Math.tan(c.hfov*Math.PI/360);a.div.style.visibility="visible";var m=C.getCanvas(),l=m.clientWidth,m=m.clientHeight,b=[-l/p*n*d/k/2,-l/p*(b*f-d*g*e)/k/2],d=Math.sin(c.roll*Math.PI/180),e=Math.cos(c.roll*Math.PI/180),b=[b[0]*e-b[1]*d,b[0]*d+b[1]*e];b[0]+=(l-a.div.offsetWidth)/2;b[1]+=(m-a.div.offsetHeight)/2;l="translate("+b[0]+"px, "+b[1]+"px) translateZ(9999px) rotate("+c.roll+"deg)";a.div.style.webkitTransform=l;a.div.style.MozTransform=
l;a.div.style.transform=l}}function g(a){c={};var b,d="haov vaov vOffset northOffset horizonPitch horizonRoll".split(" ");Z=[];for(b in Ta)Ta.hasOwnProperty(b)&&(c[b]=Ta[b]);for(b in x.default)x.default.hasOwnProperty(b)&&(c[b]=x.default[b],0<=d.indexOf(b)&&Z.push(b));if(null!==a&&""!==a&&x.scenes&&x.scenes[a]){var e=x.scenes[a];for(b in e)e.hasOwnProperty(b)&&(c[b]=e[b],0<=d.indexOf(b)&&Z.push(b));c.scene=a}for(b in x)x.hasOwnProperty(b)&&(c[b]=x[b],0<=d.indexOf(b)&&Z.push(b))}function t(a){if((a=
a?a:!1)&&"preview"in c){var b=c.preview;c.basePath&&!ja(b)&&(b=c.basePath+b);ka=f.createElement("div");ka.className="pnlm-preview-img";ka.style.backgroundImage="url('"+encodeURI(b)+"')";L.appendChild(ka)}var b=c.title,d=c.author;a&&("previewTitle"in c&&(c.title=c.previewTitle),"previewAuthor"in c&&(c.author=c.previewAuthor));c.hasOwnProperty("title")||(q.title.innerHTML="");c.hasOwnProperty("author")||(q.author.innerHTML="");c.hasOwnProperty("title")||c.hasOwnProperty("author")||(q.container.style.display=
"none");for(var e in c)if(c.hasOwnProperty(e))switch(e){case "title":q.title.innerHTML=wa(c[e]);q.container.style.display="inline";break;case "author":q.author.innerHTML="by "+wa(c[e]);q.container.style.display="inline";break;case "fallback":q.errorMsg.innerHTML='<p>Your browser does not support WebGL.<br><a href="'+encodeURI(c[e])+'" target="_blank">Click here to view this panorama in an alternative viewer.</a></p>';break;case "hfov":V(Number(c[e]));break;case "autoLoad":!0===c[e]&&C===m&&(q.load.box.style.display=
"inline",u.load.style.display="none",Ia());break;case "showZoomCtrl":u.zoom.style.display=c[e]&&!1!=c.showControls?"block":"none";break;case "showFullscreenCtrl":u.fullscreen.style.display=c[e]&&!1!=c.showControls&&("fullscreen"in f||"mozFullScreen"in f||"webkitIsFullScreen"in f||"msFullscreenElement"in f)?"block":"none";break;case "hotSpotDebug":Ua.style.display=c[e]?"block":"none";break;case "showControls":c[e]||(u.orientation.style.display="none",u.zoom.style.display="none",u.fullscreen.style.display=
"none");break;case "orientationOnByDefault":c[e]&&(Aa===m?Va=!0:!0===Aa&&Oa());break;case "loadButtonLabel":u.load.innerHTML="<p>"+wa(c[e])+"</p>"}a&&(b?c.title=b:delete c.title,d?c.author=d:delete c.author)}function z(){if(K&&!Ka)if(Da)f.exitFullscreen?f.exitFullscreen():f.mozCancelFullScreen?f.mozCancelFullScreen():f.webkitCancelFullScreen?f.webkitCancelFullScreen():f.msExitFullscreen&&f.msExitFullscreen();else try{r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():
r.msRequestFullscreen?r.msRequestFullscreen():r.webkitRequestFullScreen()}catch(a){}}function A(){f.fullscreen||f.mozFullScreen||f.webkitIsFullScreen||f.msFullscreenElement?(u.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),Da=!0):(u.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),Da=!1);C.resize();V(c.hfov);E()}function D(a){var b=c.minHfov;"multires"==c.type&&C&&(b=Math.min(b,C.getCanvas().width/(c.multiRes.cubeResolution/90*0.9)));return b>c.maxHfov?(console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),
c.hfov):a<b?b:a>c.maxHfov?c.maxHfov:a}function V(a){c.hfov=D(a)}function Ga(){J={};X=c.autoRotate?c.autoRotate:X;c.autoRotate=!1}function R(){Ka&&(q.load.box.style.display="none",q.errorMsg.style.display="none",Ka=!1,ba("errorcleared"));u.load.style.display="none";q.load.box.style.display="inline";Ia()}function F(a,b,d,e,f){K=!1;J={};var k,l;if(c.sceneFadeDuration&&!f&&(k=C.render(c.pitch*Math.PI/180,c.yaw*Math.PI/180,c.hfov*Math.PI/180,{returnImage:!0}),k!==m)){f=new Image;f.className="pnlm-fade-img";
f.style.transition="opacity "+c.sceneFadeDuration/1E3+"s";f.style.width="100%";f.style.height="100%";f.onload=function(){F(a,b,d,e,!0)};f.src=k;L.appendChild(f);C.fadeImg=f;return}f="same"===b?c.pitch:b;k="same"===d?c.yaw:"sameAzimuth"===d?c.yaw+(c.northOffset||0)-(x.scenes[a].northOffset||0):d;l="same"===e?c.hfov:e;p();g(a);w.yaw=w.pitch=w.hfov=0;t();f!==m&&(c.pitch=f);k!==m&&(c.yaw=k);l!==m&&(c.hfov=l);ba("scenechange",a);R()}function n(){I.removeEventListener("deviceorientation",Ha);u.orientation.classList.remove("pnlm-orientation-button-active");
Na=!1}function Oa(){Na=!0;Ya=c.yaw;I.addEventListener("deviceorientation",Ha);u.orientation.classList.add("pnlm-orientation-button-active");requestAnimationFrame(aa)}function wa(a){return x.escapeHTML?String(a).split(/&/g).join("&amp;").split('"').join("&quot;").split("'").join("&#39;").split("<").join("&lt;").split(">").join("&gt;").split("/").join("&#x2f;").split("\n").join("<br>"):String(a).split("\n").join("<br>")}function ba(a){if(a in U)for(var b=U[a].length;0<b;b--)U[a][U[a].length-b].apply(null,
[].slice.call(arguments,1))}var sa=this,c,C,ka,fa=!1,T=Date.now(),qa=0,ra=0,Ca=-1,La=0,Ma=0,l=Array(10),Da=!1,K=!1,Ka=!1,Pa=!1,O,ca,w={yaw:0,pitch:0,hfov:0},Qa=!1,Na=!1,Ya=0,Ra,X=0,pa,Ba,J={},U={},Z=[],Xa=!1,Sa=!1,Ta={hfov:100,minHfov:50,maxHfov:120,pitch:0,minPitch:m,maxPitch:m,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:m,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,doubleClickZoom:!0,keyboardZoom:!0,
mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0],animationTimingFunction:function(a){return 0.5>a?2*a*a:-1+(4-2*a)*a},loadButtonLabel:"Click to\nLoad\nPanorama",draggable:!0},Wa=[16,17,27,37,38,39,40,61,65,68,83,87,107,109,173,187,189];r="string"===typeof r?f.getElementById(r):r;r.classList.add("pnlm-container");r.tabIndex=0;var B=f.createElement("div");B.className="pnlm-ui";r.appendChild(B);var L=f.createElement("div");L.className=
"pnlm-render-container";r.appendChild(L);var H=f.createElement("div");H.className="pnlm-dragfix";B.appendChild(H);var q={},Ua=f.createElement("div");Ua.className="pnlm-sprite pnlm-hot-spot-debug-indicator";B.appendChild(Ua);q.container=f.createElement("div");q.container.className="pnlm-panorama-info";q.title=f.createElement("div");q.title.className="pnlm-title-box";q.container.appendChild(q.title);q.author=f.createElement("div");q.author.className="pnlm-author-box";q.container.appendChild(q.author);
B.appendChild(q.container);q.load={};q.load.box=f.createElement("div");q.load.box.className="pnlm-load-box";q.load.box.innerHTML="<p>Loading...</p>";q.load.lbox=f.createElement("div");q.load.lbox.className="pnlm-lbox";q.load.lbox.innerHTML='<div class="pnlm-loading"></div>';q.load.box.appendChild(q.load.lbox);q.load.lbar=f.createElement("div");q.load.lbar.className="pnlm-lbar";q.load.lbarFill=f.createElement("div");q.load.lbarFill.className="pnlm-lbar-fill";q.load.lbar.appendChild(q.load.lbarFill);
q.load.box.appendChild(q.load.lbar);q.load.msg=f.createElement("p");q.load.msg.className="pnlm-lmsg";q.load.box.appendChild(q.load.msg);B.appendChild(q.load.box);q.errorMsg=f.createElement("div");q.errorMsg.className="pnlm-error-msg pnlm-info-box";B.appendChild(q.errorMsg);var u={};u.container=f.createElement("div");u.container.className="pnlm-controls-container";B.appendChild(u.container);u.load=f.createElement("div");u.load.className="pnlm-load-button";u.load.addEventListener("click",function(){t();
R()});B.appendChild(u.load);u.zoom=f.createElement("div");u.zoom.className="pnlm-zoom-controls pnlm-controls";u.zoomIn=f.createElement("div");u.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control";u.zoomIn.addEventListener("click",function(){K&&(V(c.hfov-5),E())});u.zoom.appendChild(u.zoomIn);u.zoomOut=f.createElement("div");u.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control";u.zoomOut.addEventListener("click",function(){K&&(V(c.hfov+5),E())});u.zoom.appendChild(u.zoomOut);u.container.appendChild(u.zoom);
u.fullscreen=f.createElement("div");u.fullscreen.addEventListener("click",z);u.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control";(f.fullscreenEnabled||f.mozFullScreenEnabled||f.webkitFullscreenEnabled||f.msFullscreenEnabled)&&u.container.appendChild(u.fullscreen);u.orientation=f.createElement("div");u.orientation.addEventListener("click",function(a){Na?n():Oa()});u.orientation.addEventListener("mousedown",function(a){a.stopPropagation()});
u.orientation.addEventListener("touchstart",function(a){a.stopPropagation()});u.orientation.addEventListener("pointerdown",function(a){a.stopPropagation()});u.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control";var Aa,Va=!1;I.DeviceOrientationEvent?I.addEventListener("deviceorientation",Ja):Aa=!1;var Ea=f.createElement("div");Ea.className="pnlm-compass pnlm-controls pnlm-control";B.appendChild(Ea);x.firstScene?g(x.firstScene):x.default&&
x.default.firstScene?g(x.default.firstScene):g(null);t(!0);var ga=[],ta=[];Y.prototype.multiply=function(a){return new Y(this.w*a.w-this.x*a.x-this.y*a.y-this.z*a.z,this.x*a.w+this.w*a.x+this.y*a.z-this.z*a.y,this.y*a.w+this.w*a.y+this.z*a.x-this.x*a.z,this.z*a.w+this.w*a.z+this.x*a.y-this.y*a.x)};Y.prototype.toEulerAngles=function(){var a=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),b=Math.asin(2*(this.w*this.y-this.z*this.x)),c=Math.atan2(2*(this.w*this.z+this.x*
this.y),1-2*(this.y*this.y+this.z*this.z));return[a,b,c]};this.isLoaded=function(){return K};this.getPitch=function(){return c.pitch};this.setPitch=function(a,b,d,e){(b=b==m?1E3:Number(b))?J.pitch={startTime:Date.now(),startPosition:c.pitch,endPosition:a,duration:b,callback:d,callbackArgs:e}:c.pitch=a;E();return this};this.getPitchBounds=function(){return[c.minPitch,c.maxPitch]};this.setPitchBounds=function(a){c.minPitch=Math.max(-90,Math.min(a[0],90));c.maxPitch=Math.max(-90,Math.min(a[1],90));return this};
this.getYaw=function(){return c.yaw};this.setYaw=function(a,b,d,e){(b=b==m?1E3:Number(b))?J.yaw={startTime:Date.now(),startPosition:c.yaw,endPosition:a,duration:b,callback:d,callbackArgs:e}:c.yaw=a;E();return this};this.getYawBounds=function(){return[c.minYaw,c.maxYaw]};this.setYawBounds=function(a){c.minYaw=Math.max(-180,Math.min(a[0],180));c.maxYaw=Math.max(-180,Math.min(a[1],180));return this};this.getHfov=function(){return c.hfov};this.setHfov=function(a,b,d,e){(b=b==m?1E3:Number(b))?J.hfov={startTime:Date.now(),
startPosition:c.hfov,endPosition:D(a),duration:b,callback:d,callbackArgs:e}:V(a);E();return this};this.getHfovBounds=function(){return[c.minHfov,c.maxHfov]};this.setHfovBounds=function(a){c.minHfov=Math.max(0,a[0]);c.maxHfov=Math.max(0,a[1]);return this};this.lookAt=function(a,b,c,d,e,f){d=d==m?1E3:Number(d);a!==m&&(this.setPitch(a,d,e,f),e=m);b!==m&&(this.setYaw(b,d,e,f),e=m);c!==m&&this.setHfov(c,d,e,f);return this};this.getNorthOffset=function(){return c.northOffset};this.setNorthOffset=function(a){c.northOffset=
Math.min(360,Math.max(0,a));E();return this};this.getHorizonRoll=function(){return c.horizonRoll};this.setHorizonRoll=function(a){c.horizonRoll=Math.min(90,Math.max(-90,a));C.setPose(c.horizonPitch*Math.PI/180,c.horizonRoll*Math.PI/180);E();return this};this.getHorizonPitch=function(){return c.horizonPitch};this.setHorizonPitch=function(a){c.horizonPitch=Math.min(90,Math.max(-90,a));C.setPose(c.horizonPitch*Math.PI/180,c.horizonRoll*Math.PI/180);E();return this};this.startAutoRotate=function(a){a=
a||X||1;c.autoRotate=a;sa.lookAt(Ba,m,pa,3E3);E();return this};this.stopAutoRotate=function(){X=c.autoRotate?c.autoRotate:X;c.autoRotate=!1;c.autoRotateInactivityDelay=-1;return this};this.getRenderer=function(){return C};this.setUpdate=function(a){Xa=!0===a;C===m?P():E();return this};this.mouseEventToCoords=function(a){return ha(a)};this.loadScene=function(a,b,c,d){K&&F(a,b,c,d);return this};this.getScene=function(){return c.scene};this.addScene=function(a,b){x.scenes[a]=b;return this};this.removeScene=
function(a){if(c.scene===a||!x.scenes.hasOwnProperty(a))return!1;delete x.scenes[a];return!0};this.toggleFullscreen=function(){z();return this};this.getConfig=function(){return c};this.addHotSpot=function(a,d){if(d===m&&c.scene===m)c.hotSpots.push(a);else{var e=d!==m?d:c.scene;if(x.scenes.hasOwnProperty(e))x.scenes[e].hasOwnProperty("hotSpots")||(x.scenes[e].hotSpots=[],e==c.scene&&(c.hotSpots=x.scenes[e].hotSpots)),x.scenes[e].hotSpots.push(a);else throw"Invalid scene ID!";}if(d===m||c.scene==d)Fa(a),
K&&b(a);return this};this.removeHotSpot=function(a){if(!c.hotSpots)return!1;for(var b=0;b<c.hotSpots.length;b++)if(c.hotSpots[b].hasOwnProperty("id")&&c.hotSpots[b].id===a){for(a=c.hotSpots[b].div;a.parentNode!=L;)a=a.parentNode;L.removeChild(a);delete c.hotSpots[b].div;c.hotSpots.splice(b,1);return!0}return!1};this.resize=function(){A()};this.isLoaded=function(){return K};this.on=function(a,b){U[a]=U[a]||[];U[a].push(b);return this};this.off=function(a,b){if(!a)return U={},this;if(b){var c=U[a].indexOf(b);
0<=c&&U[a].splice(c,1);0==U[a].length&&delete U[a]}else delete U[a];return this};this.destroy=function(){C&&C.destroy();Pa&&(H.removeEventListener("mousedown",va,!1),H.removeEventListener("dblclick",xa,!1),f.removeEventListener("mousemove",ya,!1),f.removeEventListener("mouseup",la,!1),r.removeEventListener("mousewheel",N,!1),r.removeEventListener("DOMMouseScroll",N,!1),r.removeEventListener("mozfullscreenchange",A,!1),r.removeEventListener("webkitfullscreenchange",A,!1),r.removeEventListener("msfullscreenchange",
A,!1),r.removeEventListener("fullscreenchange",A,!1),I.removeEventListener("resize",ia,!1),I.removeEventListener("orientationchange",ia,!1),r.removeEventListener("keydown",za,!1),r.removeEventListener("keyup",na,!1),r.removeEventListener("blur",S,!1),f.removeEventListener("mouseleave",la,!1),H.removeEventListener("touchstart",ea,!1),H.removeEventListener("touchmove",ma,!1),H.removeEventListener("touchend",v,!1),H.removeEventListener("pointerdown",d,!1),H.removeEventListener("pointermove",a,!1),H.removeEventListener("pointerup",
M,!1),H.removeEventListener("pointerleave",M,!1));r.innerHTML="";r.classList.remove("pnlm-container");B.classList.remove("pnlm-grab");B.classList.remove("pnlm-grabbing")}}return{viewer:function(f,m){return new ua(f,m)}}}(window,document);
